<html><head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="siteify.css">
<script>

var lastlink;

function expand(a) {
    if ( a.children[0].style.display != "block" ) {
        if ( lastlink )
            lastlink.style.display = "none";
        a.children[0].style.display = "block";
        lastlink = a.children[0];
    }
    else {
        a.children[0].style.display = "none";
        lastlink = null;
    }
    return false;
}

</script></head><body><pre>
0001    <span class='comment'><a name='1_1'>//
0002    </a></span><span class='comment'><a name='2_1'>//  Entity.swift
0003    </a></span><span class='comment'><a name='3_1'>//  refactord
0004    </a></span><span class='comment'><a name='4_1'>//
0005    </a></span><span class='comment'><a name='5_1'>//  Created by John Holdsworth on 19/02/2016.
0006    </a></span><span class='comment'><a name='6_1'>//  Copyright Â© 2016 John Holdsworth. All rights reserved.
0007    </a></span><span class='comment'><a name='7_1'>//
0008    </a></span><span class='comment'><a name='8_1'>//  $Id: //depot/siteify/siteify/Entity.swift#3 $
0009    </a></span><span class='comment'><a name='9_1'>//
0010    </a></span><span class='comment'><a name='10_1'>//  Repo: </a></span><span class='url'><a href='https://github.com/johnno1962/Refactorator'>https://github.com/johnno1962/Refactorator</a></span><span class='comment'><a name='10_53'>
0011    </a></span><span class='comment'><a name='11_1'>//
0012    </a></span>
0013    <span class='keyword'><a name='13_1'>import</a></span> <span class='identifier'><a name='13_8'>Foundation</a></span>
0014    
0015    <span class='keyword'><a name='15_1'>var</a></span> <span class='identifier'><a name='15_5' href='#' title='s:v7siteify15filenameForFileGVSs10DictionarySSSS_' onclick='return expand(this);'>filenameForFile<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#18_23"; return false;'>Entity.swift:18</td><td><pre>    if let filename = <b>filenameForFile</b>[file] {</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#26_5"; return false;'>Entity.swift:26</td><td><pre>    <b>filenameForFile</b>[file] = filename</pre></td></table></span></a></span> = [<span class='identifier'><a name='15_24' title='s:SS'>String</a></span>:<span class='identifier'><a name='15_31' title='s:SS'>String</a></span>](), <span class='identifier'><a name='15_42' href='#' title='s:v7siteify16filesForFileNameGVSs10DictionarySSSS_' onclick='return expand(this);'>filesForFileName<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#22_11"; return false;'>Entity.swift:22</td><td><pre>    while <b>filesForFileName</b>[filename] != nil {</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#25_5"; return false;'>Entity.swift:25</td><td><pre>    <b>filesForFileName</b>[filename] = file</pre></td></table></span></a></span> = [<span class='identifier'><a name='15_62' title='s:SS'>String</a></span>:<span class='identifier'><a name='15_69' title='s:SS'>String</a></span>]()
0016    
0017    <span class='keyword'><a name='17_1'>func</a></span> <span class='identifier'><a name='17_6' href='#' title='s:F7siteify12fileFilenameFSSSS' onclick='return expand(this);'>fileFilename<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#186_20"; event.stopPropagation(); return false;'>main.swift:186</td><td><pre>    let filename = <b>fileFilename</b>( file )+".html"</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#55_16"; return false;'>Entity.swift:55</td><td><pre>        return <b>fileFilename</b>( file )</pre></td></table></span></a></span>( <span class='identifier'><a name='17_20'>file</a></span>: <span class='typeidentifier'><a name='17_26' title='s:SS'>String</a></span> ) -> <span class='typeidentifier'><a name='17_38' title='s:SS'>String</a></span> {
0018        <span class='keyword'><a name='18_5'>if</a></span> <span class='keyword'><a name='18_8'>let</a></span> <span class='identifier'><a name='18_12'>filename</a></span> = <span class='identifier'><a name='18_23' href='Entity.html#15_5' title='s:v7siteify15filenameForFileGVSs10DictionarySSSS_'>filenameForFile</a></span>[<span class='identifier'><a name='18_39'>file</a></span>] {
0019            <span class='keyword'><a name='19_9'>return</a></span> <span class='identifier'><a name='19_16'>filename</a></span>
0020        }
0021        <span class='keyword'><a name='21_5'>var</a></span> <span class='identifier'><a name='21_9'>filename</a></span> = <span class='identifier'><a name='21_20' title='c:objc(cs)NSURL(im)initFileURLWithPath:'>NSURL</a></span>( <span class='identifier'><a name='21_27'>fileURLWithPath</a></span>: <span class='identifier'><a name='21_44'>file</a></span> ).<span class='identifier'><a name='21_51' title='c:objc(cs)NSURL(py)URLByDeletingPathExtension'>URLByDeletingPathExtension</a></span>!.<span class='identifier'><a name='21_79' title='c:objc(cs)NSURL(py)lastPathComponent'>lastPathComponent</a></span>!
0022        <span class='keyword'><a name='22_5'>while</a></span> <span class='identifier'><a name='22_11' href='Entity.html#15_42' title='s:v7siteify16filesForFileNameGVSs10DictionarySSSS_'>filesForFileName</a></span>[<span class='identifier'><a name='22_28'>filename</a></span>] != <span class='keyword'><a name='22_41'>nil</a></span> {
0023            <span class='identifier'><a name='23_9'>filename</a></span> += <span class='string'><a name='23_21'>"_"</a></span>
0024        }
0025        <span class='identifier'><a name='25_5' href='Entity.html#15_42' title='s:v7siteify16filesForFileNameGVSs10DictionarySSSS_'>filesForFileName</a></span>[<span class='identifier'><a name='25_22'>filename</a></span>] = <span class='identifier'><a name='25_34'>file</a></span>
0026        <span class='identifier'><a name='26_5' href='Entity.html#15_5' title='s:v7siteify15filenameForFileGVSs10DictionarySSSS_'>filenameForFile</a></span>[<span class='identifier'><a name='26_21'>file</a></span>] = <span class='identifier'><a name='26_29'>filename</a></span>
0027        <span class='keyword'><a name='27_5'>return</a></span> <span class='identifier'><a name='27_12'>filename</a></span>
0028    }
0029    
0030    <span class='keyword'><a name='30_1'>class</a></span> <span class='identifier'><a name='30_7' href='#' title='s:C7siteify6Entity' onclick='return expand(this);'>Entity<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#102_17"; event.stopPropagation(); return false;'>main.swift:102</td><td><pre>var entities = [<b>Entity</b>:sourcekitd_variant_t]()</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#106_23"; event.stopPropagation(); return false;'>main.swift:106</td><td><pre>    var references = [<b>Entity</b>]()</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#108_20"; event.stopPropagation(); return false;'>main.swift:108</td><td><pre>    var declaring: <b>Entity</b>?</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#129_30"; event.stopPropagation(); return false;'>main.swift:129</td><td><pre>                let entity = <b>Entity</b>( file: file,</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#225_23"; event.stopPropagation(); return false;'>main.swift:225</td><td><pre>            let ent = <b>Entity</b>( file: file, line: line, col: col )</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#103_14"; return false;'>Entity.swift:103</td><td><pre>func ==(lhs: <b>Entity</b>, rhs: Entity) -> Bool {</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#103_27"; return false;'>Entity.swift:103</td><td><pre>func ==(lhs: Entity, rhs: <b>Entity</b>) -> Bool {</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#107_12"; return false;'>Entity.swift:107</td><td><pre>func &lt;(e1: <b>Entity</b>, e2: Entity) -> Bool {</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#107_24"; return false;'>Entity.swift:107</td><td><pre>func &lt;(e1: Entity, e2: <b>Entity</b>) -> Bool {</pre></td></table></span></a></span>: <span class='typeidentifier'><a name='30_15' title='s:PSs8Hashable'>Hashable</a></span> {
0031    
0032        <span class='keyword'><a name='32_5'>let</a></span> <span class='identifier'><a name='32_9' href='#' title='s:vC7siteify6Entity4fileSS' onclick='return expand(this);'>file<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#247_52"; event.stopPropagation(); return false;'>main.swift:247</td><td><pre>                            let keepListOpen = ref.<b>file</b> != decl.file ? "event.stopPropagation(); " : ""</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#247_65"; event.stopPropagation(); return false;'>main.swift:247</td><td><pre>                            let keepListOpen = ref.file != decl.<b>file</b> ? "event.stopPropagation(); " : ""</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#39_14"; return false;'>Entity.swift:39</td><td><pre>        self.<b>file</b> = file</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#55_30"; return false;'>Entity.swift:55</td><td><pre>        return fileFilename( <b>file</b> )</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#104_62"; return false;'>Entity.swift:104</td><td><pre>    return lhs.line == rhs.line &amp;&amp; lhs.col == rhs.col &amp;&amp; lhs.<b>file</b> == rhs.file</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#104_74"; return false;'>Entity.swift:104</td><td><pre>    return lhs.line == rhs.line &amp;&amp; lhs.col == rhs.col &amp;&amp; lhs.file == rhs.<b>file</b></pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#108_44"; return false;'>Entity.swift:108</td><td><pre>    let file1 = NSURL( fileURLWithPath: e1.<b>file</b> ).lastPathComponent!,</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#109_40"; return false;'>Entity.swift:109</td><td><pre>    file2 = NSURL( fileURLWithPath: e2.<b>file</b> ).lastPathComponent!</pre></td></table></span></a></span>: <span class='typeidentifier'><a name='32_15' title='s:SS'>String</a></span>
0033        <span class='keyword'><a name='33_5'>let</a></span> <span class='identifier'><a name='33_9' href='#' title='s:vC7siteify6Entity4lineSi' onclick='return expand(this);'>line<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#248_190"; event.stopPropagation(); return false;'>main.swift:248</td><td><pre>                            popup += "&lt;tr>&lt;td style='text-decoration: underline;' onclick='document.location.href=\"\(ref.href)\"; \(keepListOpen)return false;'>\(ref.filename).swift:\(ref.<b>line</b>)&lt;/td>"</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#40_14"; return false;'>Entity.swift:40</td><td><pre>        self.<b>line</b> = line</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#47_20"; return false;'>Entity.swift:47</td><td><pre>        return Int(<b>line</b> + col)</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#51_19"; return false;'>Entity.swift:51</td><td><pre>        return "\(<b>line</b>)_\(col)"</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#64_25"; return false;'>Entity.swift:64</td><td><pre>        var line = self.<b>line</b></pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#89_37"; return false;'>Entity.swift:89</td><td><pre>        return "MATCH FAILED line:\(<b>line</b>) column:\(col)"</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#104_16"; return false;'>Entity.swift:104</td><td><pre>    return lhs.<b>line</b> == rhs.line &amp;&amp; lhs.col == rhs.col &amp;&amp; lhs.file == rhs.file</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#104_28"; return false;'>Entity.swift:104</td><td><pre>    return lhs.line == rhs.<b>line</b> &amp;&amp; lhs.col == rhs.col &amp;&amp; lhs.file == rhs.file</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#112_11"; return false;'>Entity.swift:112</td><td><pre>    if e1.<b>line</b> &lt; e2.line { return true }</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#112_21"; return false;'>Entity.swift:112</td><td><pre>    if e1.line &lt; e2.<b>line</b> { return true }</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#113_11"; return false;'>Entity.swift:113</td><td><pre>    if e1.<b>line</b> > e2.line { return false }</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#113_21"; return false;'>Entity.swift:113</td><td><pre>    if e1.line > e2.<b>line</b> { return false }</pre></td></table></span></a></span>: <span class='typeidentifier'><a name='33_15' title='s:Si'>Int</a></span>
0034        <span class='keyword'><a name='34_5'>let</a></span> <span class='identifier'><a name='34_9' href='#' title='s:vC7siteify6Entity3colSi' onclick='return expand(this);'>col<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#41_14"; return false;'>Entity.swift:41</td><td><pre>        self.<b>col</b> = col</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#47_27"; return false;'>Entity.swift:47</td><td><pre>        return Int(line + <b>col</b>)</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#51_27"; return false;'>Entity.swift:51</td><td><pre>        return "\(line)_\(<b>col</b>)"</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#69_24"; return false;'>Entity.swift:69</td><td><pre>        var col = self.<b>col</b>, largecol = ""</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#89_52"; return false;'>Entity.swift:89</td><td><pre>        return "MATCH FAILED line:\(line) column:\(<b>col</b>)"</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#104_40"; return false;'>Entity.swift:104</td><td><pre>    return lhs.line == rhs.line &amp;&amp; lhs.<b>col</b> == rhs.col &amp;&amp; lhs.file == rhs.file</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#104_51"; return false;'>Entity.swift:104</td><td><pre>    return lhs.line == rhs.line &amp;&amp; lhs.col == rhs.<b>col</b> &amp;&amp; lhs.file == rhs.file</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#114_15"; return false;'>Entity.swift:114</td><td><pre>    return e1.<b>col</b> &lt; e2.col</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#114_24"; return false;'>Entity.swift:114</td><td><pre>    return e1.col &lt; e2.<b>col</b></pre></td></table></span></a></span>: <span class='typeidentifier'><a name='34_14' title='s:Si'>Int</a></span>
0035        <span class='keyword'><a name='35_5'>let</a></span> <span class='identifier'><a name='35_9' href='#' title='s:vC7siteify6Entity4kindGSqSS_' onclick='return expand(this);'>kind<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#42_14"; return false;'>Entity.swift:42</td><td><pre>        self.<b>kind</b> = kind</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#79_33"; return false;'>Entity.swift:79</td><td><pre>        var b = "&lt;b title='" + (<b>kind</b> ?? "UNKNOWN") + "'"</pre></td></table></span></a></span>: <span class='typeidentifier'><a name='35_15' title='s:SS'>String</a></span>?
0036        <span class='keyword'><a name='36_5'>let</a></span> <span class='identifier'><a name='36_9' href='#' title='s:vC7siteify6Entity4declSb' onclick='return expand(this);'>decl<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#153_19"; event.stopPropagation(); return false;'>main.swift:153</td><td><pre>        if entity.<b>decl</b>, var usr = usrs[usr] {</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#43_14"; return false;'>Entity.swift:43</td><td><pre>        self.<b>decl</b> = decl</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#80_12"; return false;'>Entity.swift:80</td><td><pre>        if <b>decl</b> {</pre></td></table></span></a></span>: <span class='typeidentifier'><a name='36_15' title='s:Sb'>Bool</a></span>
0037    
0038        <span class='keyword'><a name='38_5' href='#' title='s:FC7siteify6EntitycFMS0_FT4fileSS4lineSi3colSi4kindGSqSS_4declSb_S0_' onclick='return expand(this);'>init<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#129_30"; event.stopPropagation(); return false;'>main.swift:129</td><td><pre>                let entity = <b>Entity</b>( file: file,</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#225_23"; event.stopPropagation(); return false;'>main.swift:225</td><td><pre>            let ent = <b>Entity</b>( file: file, line: line, col: col )</pre></td></table></span></a></span>( <span class='identifier'><a name='38_11'>file</a></span>: <span class='typeidentifier'><a name='38_17' title='s:SS'>String</a></span>, <span class='identifier'><a name='38_25'>line</a></span>: <span class='typeidentifier'><a name='38_31' title='s:Si'>Int</a></span>, <span class='identifier'><a name='38_36'>col</a></span>: <span class='typeidentifier'><a name='38_41' title='s:Si'>Int</a></span>, <span class='identifier'><a name='38_46'>kind</a></span>: <span class='typeidentifier'><a name='38_52' title='s:SS'>String</a></span>? = <span class='keyword'><a name='38_62'>nil</a></span>, <span class='identifier'><a name='38_67'>decl</a></span>: <span class='typeidentifier'><a name='38_73' title='s:Sb'>Bool</a></span> = <span class='keyword'><a name='38_80'>false</a></span> ) {
0039            <span class='keyword'><a name='39_9'>self</a></span>.<span class='identifier'><a name='39_14' href='Entity.html#32_9' title='s:vC7siteify6Entity4fileSS'>file</a></span> = <span class='identifier'><a name='39_21'>file</a></span>
0040            <span class='keyword'><a name='40_9'>self</a></span>.<span class='identifier'><a name='40_14' href='Entity.html#33_9' title='s:vC7siteify6Entity4lineSi'>line</a></span> = <span class='identifier'><a name='40_21'>line</a></span>
0041            <span class='keyword'><a name='41_9'>self</a></span>.<span class='identifier'><a name='41_14' href='Entity.html#34_9' title='s:vC7siteify6Entity3colSi'>col</a></span> = <span class='identifier'><a name='41_20'>col</a></span>
0042            <span class='keyword'><a name='42_9'>self</a></span>.<span class='identifier'><a name='42_14' href='Entity.html#35_9' title='s:vC7siteify6Entity4kindGSqSS_'>kind</a></span> = <span class='identifier'><a name='42_21'>kind</a></span>
0043            <span class='keyword'><a name='43_9'>self</a></span>.<span class='identifier'><a name='43_14' href='Entity.html#36_9' title='s:vC7siteify6Entity4declSb'>decl</a></span> = <span class='identifier'><a name='43_21'>decl</a></span>
0044        }
0045    
0046        <span class='keyword'><a name='46_5'>var</a></span> <span class='identifier'><a name='46_9'>hashValue</a></span>: <span class='typeidentifier'><a name='46_20' title='s:Si'>Int</a></span> {
0047            <span class='keyword'><a name='47_9'>return</a></span> <span class='identifier'><a name='47_16' title='s:FSicFMSiFSiSi'>Int</a></span>(<span class='identifier'><a name='47_20' href='Entity.html#33_9' title='s:vC7siteify6Entity4lineSi'>line</a></span> + <span class='identifier'><a name='47_27' href='Entity.html#34_9' title='s:vC7siteify6Entity3colSi'>col</a></span>)
0048        }
0049    
0050        <span class='keyword'><a name='50_5'>var</a></span> <span class='identifier'><a name='50_9' href='#' title='s:vC7siteify6Entity6anchorSS' onclick='return expand(this);'>anchor<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#227_40"; event.stopPropagation(); return false;'>main.swift:227</td><td><pre>            var span = "&lt;a name='\(ent.<b>anchor</b>)'>\(text)&lt;/a>"</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#238_48"; event.stopPropagation(); return false;'>main.swift:238</td><td><pre>                        span = "&lt;a name='\(ent.<b>anchor</b>)' href='\(decl.href)' title='\(usrString)'>\(text)&lt;/a>"</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#251_48"; event.stopPropagation(); return false;'>main.swift:251</td><td><pre>                        span = "&lt;a name='\(ent.<b>anchor</b>)' href='#' title='\(usrString)' onclick='return expand(this);'>" +</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#256_44"; event.stopPropagation(); return false;'>main.swift:256</td><td><pre>                    span = "&lt;a name='\(ent.<b>anchor</b>)' title='\(usrString)'>\(text)&lt;/a>"</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#59_36"; return false;'>Entity.swift:59</td><td><pre>        return "\(filename).html#\(<b>anchor</b>)"</pre></td></table></span></a></span>: <span class='typeidentifier'><a name='50_17' title='s:SS'>String</a></span> {
0051            <span class='keyword'><a name='51_9'>return</a></span> <span class='string'><a name='51_16'>"</a></span>\<span class='string_interpolation_anchor'><a name='51_18'>(</a></span><span class='identifier'><a name='51_19' href='Entity.html#33_9' title='s:vC7siteify6Entity4lineSi'>line</a></span><span class='string_interpolation_anchor'><a name='51_23'>)</a></span><span class='string'><a name='51_24'>_</a></span>\<span class='string_interpolation_anchor'><a name='51_26'>(</a></span><span class='identifier'><a name='51_27' href='Entity.html#34_9' title='s:vC7siteify6Entity3colSi'>col</a></span><span class='string_interpolation_anchor'><a name='51_30'>)</a></span><span class='string'><a name='51_31'>"</a></span>
0052        }
0053    
0054        <span class='keyword'><a name='54_5'>var</a></span> <span class='identifier'><a name='54_9' href='#' title='s:vC7siteify6Entity8filenameSS' onclick='return expand(this);'>filename<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#248_168"; event.stopPropagation(); return false;'>main.swift:248</td><td><pre>                            popup += "&lt;tr>&lt;td style='text-decoration: underline;' onclick='document.location.href=\"\(ref.href)\"; \(keepListOpen)return false;'>\(ref.<b>filename</b>).swift:\(ref.line)&lt;/td>"</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#59_19"; return false;'>Entity.swift:59</td><td><pre>        return "\(<b>filename</b>).html#\(anchor)"</pre></td></table></span></a></span>: <span class='typeidentifier'><a name='54_19' title='s:SS'>String</a></span> {
0055            <span class='keyword'><a name='55_9'>return</a></span> <span class='identifier'><a name='55_16' href='Entity.html#17_6' title='s:F7siteify12fileFilenameFSSSS'>fileFilename</a></span>( <span class='identifier'><a name='55_30' href='Entity.html#32_9' title='s:vC7siteify6Entity4fileSS'>file</a></span> )
0056        }
0057    
0058        <span class='keyword'><a name='58_5'>var</a></span> <span class='identifier'><a name='58_9' href='#' title='s:vC7siteify6Entity4hrefSS' onclick='return expand(this);'>href<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#238_70"; event.stopPropagation(); return false;'>main.swift:238</td><td><pre>                        span = "&lt;a name='\(ent.anchor)' href='\(decl.<b>href</b>)' title='\(usrString)'>\(text)&lt;/a>"</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#248_123"; event.stopPropagation(); return false;'>main.swift:248</td><td><pre>                            popup += "&lt;tr>&lt;td style='text-decoration: underline;' onclick='document.location.href=\"\(ref.<b>href</b>)\"; \(keepListOpen)return false;'>\(ref.filename).swift:\(ref.line)&lt;/td>"</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#287_72"; event.stopPropagation(); return false;'>main.swift:287</td><td><pre>        xrefData.append( (_stdlib_demangleName( "_T"+usrString ), decl.<b>href</b>) )</pre></td></table></span></a></span>: <span class='typeidentifier'><a name='58_15' title='s:SS'>String</a></span> {
0059            <span class='keyword'><a name='59_9'>return</a></span> <span class='string'><a name='59_16'>"</a></span>\<span class='string_interpolation_anchor'><a name='59_18'>(</a></span><span class='identifier'><a name='59_19' href='Entity.html#54_9' title='s:vC7siteify6Entity8filenameSS'>filename</a></span><span class='string_interpolation_anchor'><a name='59_27'>)</a></span><span class='string'><a name='59_28'>.html#</a></span>\<span class='string_interpolation_anchor'><a name='59_35'>(</a></span><span class='identifier'><a name='59_36' href='Entity.html#50_9' title='s:vC7siteify6Entity6anchorSS'>anchor</a></span><span class='string_interpolation_anchor'><a name='59_42'>)</a></span><span class='string'><a name='59_43'>"</a></span>
0060        }
0061    
0062        <span class='keyword'><a name='62_5'>func</a></span> <span class='identifier'><a name='62_10' href='#' title='s:FC7siteify6Entity5regexFS0_FSSCS_9ByteRegex' onclick='return expand(this);'>regex<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#84_26"; return false;'>Entity.swift:84</td><td><pre>        if let matches = <b>regex</b>( value ).match( contents ) {</pre></td></table></span></a></span>( <span class='identifier'><a name='62_17'>text</a></span>: <span class='typeidentifier'><a name='62_23' title='s:SS'>String</a></span> ) -> <span class='typeidentifier'><a name='62_35' href='ByteRegex.html#23_7' title='s:C7siteify9ByteRegex'>ByteRegex</a></span> {
0063            <span class='keyword'><a name='63_9'>var</a></span> <span class='identifier'><a name='63_13'>pattern</a></span> = <span class='string'><a name='63_23'>"^"</a></span>
0064            <span class='keyword'><a name='64_9'>var</a></span> <span class='identifier'><a name='64_13'>line</a></span> = <span class='keyword'><a name='64_20'>self</a></span>.<span class='identifier'><a name='64_25' href='Entity.html#33_9' title='s:vC7siteify6Entity4lineSi'>line</a></span>
0065            <span class='keyword'><a name='65_9'>while</a></span> <span class='identifier'><a name='65_15'>line</a></span> > <span class='number'><a name='65_22'>100</a></span> {
0066                <span class='identifier'><a name='66_13'>pattern</a></span> += <span class='string'><a name='66_24'>"(?:[^\n]*\n){100}"</a></span>
0067                <span class='identifier'><a name='67_13'>line</a></span> -= <span class='number'><a name='67_21'>100</a></span>
0068            }
0069            <span class='keyword'><a name='69_9'>var</a></span> <span class='identifier'><a name='69_13'>col</a></span> = <span class='keyword'><a name='69_19'>self</a></span>.<span class='identifier'><a name='69_24' href='Entity.html#34_9' title='s:vC7siteify6Entity3colSi'>col</a></span>, <span class='identifier'><a name='69_29'>largecol</a></span> = <span class='string'><a name='69_40'>""</a></span>
0070            <span class='keyword'><a name='70_9'>while</a></span> <span class='identifier'><a name='70_15'>col</a></span> > <span class='number'><a name='70_21'>100</a></span> {
0071                <span class='identifier'><a name='71_13'>largecol</a></span> += <span class='string'><a name='71_25'>".{100}"</a></span>
0072                <span class='identifier'><a name='72_13'>col</a></span> -= <span class='number'><a name='72_20'>100</a></span>
0073            }
0074            <span class='identifier'><a name='74_9'>pattern</a></span> += <span class='string'><a name='74_20'>"(?:[^\n]*\n){</a></span>\<span class='string_interpolation_anchor'><a name='74_35'>(</a></span><span class='identifier'><a name='74_36'>line</a></span>-<span class='number'><a name='74_41'>1</a></span><span class='string_interpolation_anchor'><a name='74_42'>)</a></span><span class='string'><a name='74_43'>}(</a></span>\<span class='string_interpolation_anchor'><a name='74_46'>(</a></span><span class='identifier'><a name='74_47'>largecol</a></span><span class='string_interpolation_anchor'><a name='74_55'>)</a></span><span class='string'><a name='74_56'>.{</a></span>\<span class='string_interpolation_anchor'><a name='74_59'>(</a></span><span class='identifier'><a name='74_60'>col</a></span>-<span class='number'><a name='74_64'>1</a></span><span class='string_interpolation_anchor'><a name='74_65'>)</a></span><span class='string'><a name='74_66'>}[^\n]*?)(</a></span>\<span class='string_interpolation_anchor'><a name='74_77'>(</a></span><span class='identifier'><a name='74_78'>text</a></span><span class='string_interpolation_anchor'><a name='74_82'>)</a></span><span class='string'><a name='74_83'>)([^\n]*)"</a></span>
0075            <span class='keyword'><a name='75_9'>return</a></span> <span class='identifier'><a name='75_16' href='ByteRegex.html#28_5' title='s:FC7siteify9ByteRegexcFMS0_FT7patternSS6cflagsVSs5Int32_S0_'>ByteRegex</a></span>( <span class='identifier'><a name='75_27'>pattern</a></span>: <span class='identifier'><a name='75_36'>pattern</a></span> )
0076        }
0077    
0078        <span class='keyword'><a name='78_5'>func</a></span> <span class='identifier'><a name='78_10' href='#' title='s:FC7siteify6Entity9patchTextFS0_FTCSo6NSData5valueSS_GSqSS_' onclick='return expand(this);'>patchText<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#140_49"; event.stopPropagation(); return false;'>main.swift:140</td><td><pre>                    usr.reflines.append( entity.<b>patchText</b>( data, value: "\\w*" )! )</pre></td></table></span></a></span>( <span class='identifier'><a name='78_21'>contents</a></span>: <span class='typeidentifier'><a name='78_31' title='c:objc(cs)NSData'>NSData</a></span>, <span class='identifier'><a name='78_39'>value</a></span>: <span class='typeidentifier'><a name='78_46' title='s:SS'>String</a></span> ) -> <span class='typeidentifier'><a name='78_58' title='s:SS'>String</a></span>? {
0079            <span class='keyword'><a name='79_9'>var</a></span> <span class='identifier'><a name='79_13'>b</a></span> = <span class='string'><a name='79_17'>"&lt;b title='"</a></span> + (<span class='identifier'><a name='79_33' href='Entity.html#35_9' title='s:vC7siteify6Entity4kindGSqSS_'>kind</a></span> ?? <span class='string'><a name='79_41'>"UNKNOWN"</a></span>) + <span class='string'><a name='79_54'>"'"</a></span>
0080            <span class='keyword'><a name='80_9'>if</a></span> <span class='identifier'><a name='80_12' href='Entity.html#36_9' title='s:vC7siteify6Entity4declSb'>decl</a></span> {
0081                <span class='identifier'><a name='81_13'>b</a></span> += <span class='string'><a name='81_18'>" style='color: blue'"</a></span>
0082            }
0083            <span class='identifier'><a name='83_9'>b</a></span> += <span class='string'><a name='83_14'>">"</a></span>
0084            <span class='keyword'><a name='84_9'>if</a></span> <span class='keyword'><a name='84_12'>let</a></span> <span class='identifier'><a name='84_16'>matches</a></span> = <span class='identifier'><a name='84_26' href='Entity.html#62_10' title='s:FC7siteify6Entity5regexFS0_FSSCS_9ByteRegex'>regex</a></span>( <span class='identifier'><a name='84_33'>value</a></span> ).<span class='identifier'><a name='84_41' href='ByteRegex.html#37_10' title='s:FC7siteify9ByteRegex5matchFS0_FTCSo6NSData6mflagsVSs5Int32_GSqGSaVSC10regmatch_t__'>match</a></span>( <span class='identifier'><a name='84_48'>contents</a></span> ) {
0085                <span class='keyword'><a name='85_13'>return</a></span> <span class='identifier'><a name='85_20' href='Entity.html#92_10' title='s:FC7siteify6Entity9htmlCleanFS0_FTCSo6NSData5matchVSC10regmatch_t_SS'>htmlClean</a></span>( <span class='identifier'><a name='85_31'>contents</a></span>, <span class='identifier'><a name='85_41'>match</a></span>: <span class='identifier'><a name='85_48'>matches</a></span>[<span class='number'><a name='85_56'>1</a></span>] ) +
0086                    <span class='string'><a name='86_17'>"&lt;b>"</a></span> + <span class='identifier'><a name='86_25' href='Entity.html#92_10' title='s:FC7siteify6Entity9htmlCleanFS0_FTCSo6NSData5matchVSC10regmatch_t_SS'>htmlClean</a></span>( <span class='identifier'><a name='86_36'>contents</a></span>, <span class='identifier'><a name='86_46'>match</a></span>: <span class='identifier'><a name='86_53'>matches</a></span>[<span class='number'><a name='86_61'>2</a></span>] ) + <span class='string'><a name='86_68'>"&lt;/b>"</a></span> +
0087                    <span class='identifier'><a name='87_17' href='Entity.html#92_10' title='s:FC7siteify6Entity9htmlCleanFS0_FTCSo6NSData5matchVSC10regmatch_t_SS'>htmlClean</a></span>( <span class='identifier'><a name='87_28'>contents</a></span>, <span class='identifier'><a name='87_38'>match</a></span>: <span class='identifier'><a name='87_45'>matches</a></span>[<span class='number'><a name='87_53'>3</a></span>] )
0088            }
0089            <span class='keyword'><a name='89_9'>return</a></span> <span class='string'><a name='89_16'>"MATCH FAILED line:</a></span>\<span class='string_interpolation_anchor'><a name='89_36'>(</a></span><span class='identifier'><a name='89_37' href='Entity.html#33_9' title='s:vC7siteify6Entity4lineSi'>line</a></span><span class='string_interpolation_anchor'><a name='89_41'>)</a></span><span class='string'><a name='89_42'> column:</a></span>\<span class='string_interpolation_anchor'><a name='89_51'>(</a></span><span class='identifier'><a name='89_52' href='Entity.html#34_9' title='s:vC7siteify6Entity3colSi'>col</a></span><span class='string_interpolation_anchor'><a name='89_55'>)</a></span><span class='string'><a name='89_56'>"</a></span>
0090        }
0091    
0092        <span class='keyword'><a name='92_5'>func</a></span> <span class='identifier'><a name='92_10' href='#' title='s:FC7siteify6Entity9htmlCleanFS0_FTCSo6NSData5matchVSC10regmatch_t_SS' onclick='return expand(this);'>htmlClean<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#85_20"; return false;'>Entity.swift:85</td><td><pre>            return <b>htmlClean</b>( contents, match: matches[1] ) +</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#86_25"; return false;'>Entity.swift:86</td><td><pre>                "&lt;b>" + <b>htmlClean</b>( contents, match: matches[2] ) + "&lt;/b>" +</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#87_17"; return false;'>Entity.swift:87</td><td><pre>                <b>htmlClean</b>( contents, match: matches[3] )</pre></td></table></span></a></span>( <span class='identifier'><a name='92_21'>contents</a></span>: <span class='typeidentifier'><a name='92_31' title='c:objc(cs)NSData'>NSData</a></span>, <span class='identifier'><a name='92_39'>match</a></span>: <span class='typeidentifier'><a name='92_46' title='c:@SA@regmatch_t'>regmatch_t</a></span> ) -> <span class='typeidentifier'><a name='92_62' title='s:SS'>String</a></span> {
0093            <span class='keyword'><a name='93_9'>var</a></span> <span class='identifier'><a name='93_13'>range</a></span> = <span class='identifier'><a name='93_21'>match</a></span>.<span class='identifier'><a name='93_27' href='ByteRegex.html#17_9' title='s:vE7siteifyVSC10regmatch_t5rangeVSC8_NSRange'>range</a></span>
0094            <span class='keyword'><a name='94_9'>if</a></span> <span class='identifier'><a name='94_12'>range</a></span>.<span class='identifier'><a name='94_18' title='c:@S@_NSRange@FI@length'>length</a></span> > <span class='identifier'><a name='94_27'>contents</a></span>.<span class='identifier'><a name='94_36' title='c:objc(cs)NSData(py)length'>length</a></span> - <span class='identifier'><a name='94_45'>range</a></span>.<span class='identifier'><a name='94_51' title='c:@S@_NSRange@FI@location'>location</a></span> {
0095                <span class='identifier'><a name='95_13'>range</a></span>.<span class='identifier'><a name='95_19' title='c:@S@_NSRange@FI@length'>length</a></span> = <span class='identifier'><a name='95_28'>contents</a></span>.<span class='identifier'><a name='95_37' title='c:objc(cs)NSData(py)length'>length</a></span> - <span class='identifier'><a name='95_46'>range</a></span>.<span class='identifier'><a name='95_52' title='c:@S@_NSRange@FI@location'>location</a></span>
0096            }
0097            <span class='keyword'><a name='97_9'>return</a></span> <span class='identifier'><a name='97_16' title='s:SS'>String</a></span>.<span class='identifier'><a name='97_23' href='LineGenerators.html#110_17' title='s:ZFE7siteifySS8fromDataFMSSFTCSo6NSData8encodingSu_GSqSS_'>fromData</a></span>( <span class='identifier'><a name='97_33'>contents</a></span>.<span class='identifier'><a name='97_42' title='c:objc(cs)NSData(im)subdataWithRange:'>subdataWithRange</a></span>( <span class='identifier'><a name='97_60'>range</a></span> ) )?
0098                .<span class='identifier'><a name='98_14' title='s:FE10FoundationSS36stringByReplacingOccurrencesOfStringFSSFTSS10withStringSS7optionsVSC22NSStringCompareOptions5rangeGSqGVSs5RangeVVSS13CharacterView5Index___SS'>stringByReplacingOccurrencesOfString</a></span>( <span class='string'><a name='98_52'>"&amp;"</a></span>, <span class='identifier'><a name='98_57'>withString</a></span>: <span class='string'><a name='98_69'>"&amp;amp;"</a></span> )
0099                .<span class='identifier'><a name='99_14' title='s:FE10FoundationSS36stringByReplacingOccurrencesOfStringFSSFTSS10withStringSS7optionsVSC22NSStringCompareOptions5rangeGSqGVSs5RangeVVSS13CharacterView5Index___SS'>stringByReplacingOccurrencesOfString</a></span>( <span class='string'><a name='99_52'>"&lt;"</a></span>, <span class='identifier'><a name='99_57'>withString</a></span>: <span class='string'><a name='99_69'>"&amp;lt;"</a></span> ) ?? <span class='string'><a name='99_81'>"CONVERSION FAILED"</a></span>
0100        }
0101    }
0102    
0103    <span class='keyword'><a name='103_1'>func</a></span> ==(<span class='identifier'><a name='103_9'>lhs</a></span>: <span class='typeidentifier'><a name='103_14' href='Entity.html#30_7' title='s:C7siteify6Entity'>Entity</a></span>, <span class='identifier'><a name='103_22'>rhs</a></span>: <span class='typeidentifier'><a name='103_27' href='Entity.html#30_7' title='s:C7siteify6Entity'>Entity</a></span>) -> <span class='typeidentifier'><a name='103_38' title='s:Sb'>Bool</a></span> {
0104        <span class='keyword'><a name='104_5'>return</a></span> <span class='identifier'><a name='104_12'>lhs</a></span>.<span class='identifier'><a name='104_16' href='Entity.html#33_9' title='s:vC7siteify6Entity4lineSi'>line</a></span> == <span class='identifier'><a name='104_24'>rhs</a></span>.<span class='identifier'><a name='104_28' href='Entity.html#33_9' title='s:vC7siteify6Entity4lineSi'>line</a></span> &amp;&amp; <span class='identifier'><a name='104_36'>lhs</a></span>.<span class='identifier'><a name='104_40' href='Entity.html#34_9' title='s:vC7siteify6Entity3colSi'>col</a></span> == <span class='identifier'><a name='104_47'>rhs</a></span>.<span class='identifier'><a name='104_51' href='Entity.html#34_9' title='s:vC7siteify6Entity3colSi'>col</a></span> &amp;&amp; <span class='identifier'><a name='104_58'>lhs</a></span>.<span class='identifier'><a name='104_62' href='Entity.html#32_9' title='s:vC7siteify6Entity4fileSS'>file</a></span> == <span class='identifier'><a name='104_70'>rhs</a></span>.<span class='identifier'><a name='104_74' href='Entity.html#32_9' title='s:vC7siteify6Entity4fileSS'>file</a></span>
0105    }
0106    
0107    <span class='keyword'><a name='107_1'>func</a></span> &lt;(<span class='identifier'><a name='107_8'>e1</a></span>: <span class='typeidentifier'><a name='107_12' href='Entity.html#30_7' title='s:C7siteify6Entity'>Entity</a></span>, <span class='identifier'><a name='107_20'>e2</a></span>: <span class='typeidentifier'><a name='107_24' href='Entity.html#30_7' title='s:C7siteify6Entity'>Entity</a></span>) -> <span class='typeidentifier'><a name='107_35' title='s:Sb'>Bool</a></span> {
0108        <span class='keyword'><a name='108_5'>let</a></span> <span class='identifier'><a name='108_9'>file1</a></span> = <span class='identifier'><a name='108_17' title='c:objc(cs)NSURL(im)initFileURLWithPath:'>NSURL</a></span>( <span class='identifier'><a name='108_24'>fileURLWithPath</a></span>: <span class='identifier'><a name='108_41'>e1</a></span>.<span class='identifier'><a name='108_44' href='Entity.html#32_9' title='s:vC7siteify6Entity4fileSS'>file</a></span> ).<span class='identifier'><a name='108_51' title='c:objc(cs)NSURL(py)lastPathComponent'>lastPathComponent</a></span>!,
0109        <span class='identifier'><a name='109_5'>file2</a></span> = <span class='identifier'><a name='109_13' title='c:objc(cs)NSURL(im)initFileURLWithPath:'>NSURL</a></span>( <span class='identifier'><a name='109_20'>fileURLWithPath</a></span>: <span class='identifier'><a name='109_37'>e2</a></span>.<span class='identifier'><a name='109_40' href='Entity.html#32_9' title='s:vC7siteify6Entity4fileSS'>file</a></span> ).<span class='identifier'><a name='109_47' title='c:objc(cs)NSURL(py)lastPathComponent'>lastPathComponent</a></span>!
0110        <span class='keyword'><a name='110_5'>if</a></span> <span class='identifier'><a name='110_8'>file1</a></span> &lt; <span class='identifier'><a name='110_16'>file2</a></span> { <span class='keyword'><a name='110_24'>return</a></span> <span class='keyword'><a name='110_31'>true</a></span> }
0111        <span class='keyword'><a name='111_5'>if</a></span> <span class='identifier'><a name='111_8'>file1</a></span> > <span class='identifier'><a name='111_16'>file2</a></span> { <span class='keyword'><a name='111_24'>return</a></span> <span class='keyword'><a name='111_31'>false</a></span> }
0112        <span class='keyword'><a name='112_5'>if</a></span> <span class='identifier'><a name='112_8'>e1</a></span>.<span class='identifier'><a name='112_11' href='Entity.html#33_9' title='s:vC7siteify6Entity4lineSi'>line</a></span> &lt; <span class='identifier'><a name='112_18'>e2</a></span>.<span class='identifier'><a name='112_21' href='Entity.html#33_9' title='s:vC7siteify6Entity4lineSi'>line</a></span> { <span class='keyword'><a name='112_28'>return</a></span> <span class='keyword'><a name='112_35'>true</a></span> }
0113        <span class='keyword'><a name='113_5'>if</a></span> <span class='identifier'><a name='113_8'>e1</a></span>.<span class='identifier'><a name='113_11' href='Entity.html#33_9' title='s:vC7siteify6Entity4lineSi'>line</a></span> > <span class='identifier'><a name='113_18'>e2</a></span>.<span class='identifier'><a name='113_21' href='Entity.html#33_9' title='s:vC7siteify6Entity4lineSi'>line</a></span> { <span class='keyword'><a name='113_28'>return</a></span> <span class='keyword'><a name='113_35'>false</a></span> }
0114        <span class='keyword'><a name='114_5'>return</a></span> <span class='identifier'><a name='114_12'>e1</a></span>.<span class='identifier'><a name='114_15' href='Entity.html#34_9' title='s:vC7siteify6Entity3colSi'>col</a></span> &lt; <span class='identifier'><a name='114_21'>e2</a></span>.<span class='identifier'><a name='114_24' href='Entity.html#34_9' title='s:vC7siteify6Entity3colSi'>col</a></span>
0115    }
0116    