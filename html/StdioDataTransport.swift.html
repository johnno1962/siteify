<html><head>
    <meta charset="UTF-8">
    <title>.build/checkouts/SwiftLSPClient/SwiftLSPClient/JSONRPC/StdioDataTransport.swift</title>
    <link rel="stylesheet" type="text/css" href="siteify.css">
    <script src="siteify.js"></script>
</head><html><body class=source>
<h2><img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAABRJJREFUWAnFV1tIZWUU/vY+6klxoLwMNurYVOboSDZTlIym85KR0IOMw0BCGvTggwRCzxH00ku+NMTQFM0QxUhCUzopKaX0IFnkoIwXvCGiOU5q3o5Hz97771tb3Z299XiOYLTgO//+L2ut71//bR0NbtFYTSIeJ+IIqUcSxY4QsUksE1uERRxJxEm4iMPHFhcXx8Ibvd9KKRAqGAw+pAz29PTcbmxsvMNxQsT0jj+sHj5D+RZCZ9bX10cPU9olANM0sby8jLW1tdDs7Oz1ysrKD6n3gJBISISiipdAPDWe2draGjxMc4+AlIZhgFHA6uqqqev6naKioneoGzMJ3eNICGk+nw/REBcXB0F8fDzS09OhaZovJyfn8sjIyBe0cYoQ2+ETZHW/eAnICI0zwWEQctIv5R6JpKQkIYG8vLyK8fHxr2gnlo3sYiRs/cSzDG1UsSxLCbgPVCgUUhMTE2p7e9vRm56e/p22ThMJRMRIHBQBjo8uMlsRKSUaIrIfSAaBQAAZGRnPz83NtbM5k4hIIpyZfMvAs5zGPZYxiTKCgM8POsPm5qZNgMfTLsVAYmJib0lJyVs8KVOsyr0R8XQIAVmCIieO3g+G3CtmYFGFBr5UlmnYyyHLwAgoOlQ8mmpwcFDxnviedmVP+AiXxLYEoYCtpJYmeMINt4HEFN6BQRi9H9vLIRszISEBfr8fqampyM7ORkpKyutNTU0VVJQJhkfdZStyBIJryhztUsoMqVDfLaW2A65AWA/H1dYnFcq4f9fZmNwP9ubknaJ4samBgQHZDxIF16RdFRed8Io/GdqjOTB+/Ai+py7B+O59qJU/nRFa2pOMgg6z+wbLDTsSe5tzLyKZmZnnqJBIiE8nCrEREI2TT0N/4iKM5vd2yluNsKb+YI8I7QWJxRWo+z/ttPB0CAmBkEhOTk5jxyM7g+0h9k/MBGS0fvZl6Odeg/ntNbo8AePTd2H+cB1q9S9ofwegbViwhvscx6KzR4I3psx+3wvrfQ1F51DxlV2FtrkFs/WGbdxq/xrWL3ehNkw7rmpu3tEX5x7Z13AQAfegwDozhGSXHf3VNxkOP8zb13iq+fBtLEHj6Vb80TVJJyKK2HbZj7oEauQezG8+g1qUB+5f0V+5Cv3SFTvsYOgRsKAR2CSOIAdFwKWuXSiFNv8AxttV0E+fAdJ5knzkPTUGa352Zzp8lrkeO3fcb31Q/b9CO/+Sy06kSlQCoqhXXoZ2KgdW0wewhn6mU1cUd2skkXaSy7EOq6sdvuMkICS0516A7/MW6F0ddNABNTYKbXWFTtOgXXgR+pU3oOXmAetrsJrlNT66yLTkqjzvuuaOsSK2d304IYy6Canwn8r/TiDqJmSmg87OTuTm5trpV3l5OVpaWlBdXY3u7m4UFhZiYWEB/f394FOM4uJiTE1NYWhoyM4Va2trD41gVAJtbW2oqqrC0tKSnf0y30NHRwcKCgowPDxsP7dMv+z0vKGhwXaWn5+PyclJRHMug6MuQX19PXp7e9HV1QVmNmhubkZNTQ3a29uRlZXlzG5mZgY3b94EkxCnLZaPgwg4O1QMtLa22rmepN+S+Up4S0tLIbMuKytzfEjiUVdXBz67TtsBHy7b3v6Ix1Cy3uMQOox6DHmdwZ1zsUFy/2MSsS0+HPFals5lPqMXWZ4gvP2O4hE/xPEaIX9eXQS8ayJ7QlJzSR6klH7vGDYdScShYJuQv/JSOk/mP8kXIQTYC1wuAAAAAElFTkSuQmCC'> Source: .build/checkouts/SwiftLSPClient/SwiftLSPClient/JSONRPC/StdioDataTransport.swift (Return to <a href='index.html'>Index</a>)</h2>
<h3>Repo: <a href='https://github.com/ChimeHQ/SwiftLSPClient.git'>https://github.com/ChimeHQ/SwiftLSPClient.git</a></h3>
<table><tr><td>Initial Commit:<td class=crdate>Wed Nov 21 20:31:36 2018 -0500
<tr><td>Last modified:<td class=mdate>Wed Oct 30 20:18:44 2019 -0400</table><script>

var repo = "https://github.com/ChimeHQ/SwiftLSPClient";
var commits = {
  "2ef41fe" : {
    "author" : "Matt Massicotte ",
    "date" : "Thu Mar 14 14:32:22 2019 -0400",
    "hash" : "2ef41fed37b3716878e4e0f396de202ad04f2492",
    "message" : "\n    Prevent writes on close\n"
  },
  "74fc015" : {
    "author" : "Matt Massicotte ",
    "date" : "Thu Dec 13 11:35:30 2018 -0500",
    "hash" : "74fc015cdd6f5b53e1bc3a6c52100083f63fdb7f",
    "message" : "\n    Provide simple handling for the server going away and pipes becoming unreadable\n"
  },
  "d8e3f45" : {
    "author" : "Matt Massicotte ",
    "date" : "Wed Oct 30 20:18:44 2019 -0400",
    "hash" : "d8e3f458ee09bc875273d0e80a4c2fc93e5885f9",
    "message" : "\n    Safety for protocol classes (#30)\n    \n    It turns out that I was assuming that NSFileManager still did its synchronization via a runloop exclusively. This was incredibly incorrect.\n    \n    This adds actual synchronization and also includes some tests to make sure things work as expected.\n"
  },
  "d86bb6b" : {
    "author" : "Matt Massicotte ",
    "date" : "Wed Nov 21 20:31:36 2018 -0500",
    "hash" : "d86bb6b65e09db8e460b2d36d969f147ab6b8d1b",
    "message" : "\n    Migrating in code\n"
  }
};

</script><table><td valign=top><pre><script> lineLink("d86bb6b", 1542850296, "0001") </script>
<script> lineLink("d86bb6b", 1542850296, "0002") </script>
<script> lineLink("d86bb6b", 1542850296, "0003") </script>
<script> lineLink("d86bb6b", 1542850296, "0004") </script>
<script> lineLink("d86bb6b", 1542850296, "0005") </script>
<script> lineLink("d86bb6b", 1542850296, "0006") </script>
<script> lineLink("d86bb6b", 1542850296, "0007") </script>
<script> lineLink("d86bb6b", 1542850296, "0008") </script>
<script> lineLink("d86bb6b", 1542850296, "0009") </script>
<script> lineLink("d86bb6b", 1542850296, "0010") </script>
<script> lineLink("d86bb6b", 1542850296, "0011") </script>
<script> lineLink("d86bb6b", 1542850296, "0012") </script>
<script> lineLink("d86bb6b", 1542850296, "0013") </script>
<script> lineLink("d86bb6b", 1542850296, "0014") </script>
<script> lineLink("d86bb6b", 1542850296, "0015") </script>
<script> lineLink("2ef41fe", 1552588342, "0016") </script>
<script> lineLink("d8e3f45", 1572481124, "0017") </script>
<script> lineLink("d86bb6b", 1542850296, "0018") </script>
<script> lineLink("d86bb6b", 1542850296, "0019") </script>
<script> lineLink("d86bb6b", 1542850296, "0020") </script>
<script> lineLink("d86bb6b", 1542850296, "0021") </script>
<script> lineLink("d86bb6b", 1542850296, "0022") </script>
<script> lineLink("d86bb6b", 1542850296, "0023") </script>
<script> lineLink("2ef41fe", 1552588342, "0024") </script>
<script> lineLink("d8e3f45", 1572481124, "0025") </script>
<script> lineLink("74fc015", 1544718930, "0026") </script>
<script> lineLink("d8e3f45", 1572481124, "0027") </script>
<script> lineLink("d86bb6b", 1542850296, "0028") </script>
<script> lineLink("d86bb6b", 1542850296, "0029") </script>
<script> lineLink("d86bb6b", 1542850296, "0030") </script>
<script> lineLink("2ef41fe", 1552588342, "0031") </script>
<script> lineLink("2ef41fe", 1552588342, "0032") </script>
<script> lineLink("2ef41fe", 1552588342, "0033") </script>
<script> lineLink("2ef41fe", 1552588342, "0034") </script>
<script> lineLink("d8e3f45", 1572481124, "0035") </script>
<script> lineLink("d8e3f45", 1572481124, "0036") </script>
<script> lineLink("d8e3f45", 1572481124, "0037") </script>
<script> lineLink("d8e3f45", 1572481124, "0038") </script>
<script> lineLink("d8e3f45", 1572481124, "0039") </script>
<script> lineLink("d86bb6b", 1542850296, "0040") </script>
<script> lineLink("d86bb6b", 1542850296, "0041") </script>
<script> lineLink("d86bb6b", 1542850296, "0042") </script>
<script> lineLink("d8e3f45", 1572481124, "0043") </script>
<script> lineLink("d8e3f45", 1572481124, "0044") </script>
<script> lineLink("d8e3f45", 1572481124, "0045") </script>
<script> lineLink("d86bb6b", 1542850296, "0046") </script>
<script> lineLink("74fc015", 1544718930, "0047") </script>
<script> lineLink("74fc015", 1544718930, "0048") </script>
<script> lineLink("d8e3f45", 1572481124, "0049") </script>
<script> lineLink("d8e3f45", 1572481124, "0050") </script>
<script> lineLink("d8e3f45", 1572481124, "0051") </script>
<script> lineLink("d8e3f45", 1572481124, "0052") </script>
<script> lineLink("d8e3f45", 1572481124, "0053") </script>
<script> lineLink("d8e3f45", 1572481124, "0054") </script>
<script> lineLink("d8e3f45", 1572481124, "0055") </script>
<script> lineLink("d8e3f45", 1572481124, "0056") </script>
<script> lineLink("d8e3f45", 1572481124, "0057") </script>
<script> lineLink("d8e3f45", 1572481124, "0058") </script>
<script> lineLink("d8e3f45", 1572481124, "0059") </script>
<script> lineLink("2ef41fe", 1552588342, "0060") </script>
<script> lineLink("d8e3f45", 1572481124, "0061") </script>
<script> lineLink("2ef41fe", 1552588342, "0062") </script>
<script> lineLink("d8e3f45", 1572481124, "0063") </script>
<script> lineLink("d8e3f45", 1572481124, "0064") </script>
<script> lineLink("d8e3f45", 1572481124, "0065") </script>
<script> lineLink("d8e3f45", 1572481124, "0066") </script>
<script> lineLink("d8e3f45", 1572481124, "0067") </script>
<script> lineLink("d8e3f45", 1572481124, "0068") </script>
<script> lineLink("d8e3f45", 1572481124, "0069") </script>
<script> lineLink("d8e3f45", 1572481124, "0070") </script>
<script> lineLink("d8e3f45", 1572481124, "0071") </script>
<script> lineLink("d8e3f45", 1572481124, "0072") </script>
<script> lineLink("d8e3f45", 1572481124, "0073") </script>
<script> lineLink("d8e3f45", 1572481124, "0074") </script>
<script> lineLink("d8e3f45", 1572481124, "0075") </script>
<script> lineLink("d8e3f45", 1572481124, "0076") </script>
<script> lineLink("d8e3f45", 1572481124, "0077") </script>
<script> lineLink("d8e3f45", 1572481124, "0078") </script>
<script> lineLink("d8e3f45", 1572481124, "0079") </script>
<script> lineLink("d8e3f45", 1572481124, "0080") </script>
<script> lineLink("d8e3f45", 1572481124, "0081") </script>
<script> lineLink("d8e3f45", 1572481124, "0082") </script>
<script> lineLink("d8e3f45", 1572481124, "0083") </script>
<script> lineLink("d8e3f45", 1572481124, "0084") </script>
<script> lineLink("d8e3f45", 1572481124, "0085") </script>
<script> lineLink("d8e3f45", 1572481124, "0086") </script>
<script> lineLink("d8e3f45", 1572481124, "0087") </script>
<script> lineLink("d8e3f45", 1572481124, "0088") </script>
<script> lineLink("d8e3f45", 1572481124, "0089") </script>
<script> lineLink("d8e3f45", 1572481124, "0090") </script>
<script> lineLink("d8e3f45", 1572481124, "0091") </script>
<script> lineLink("d8e3f45", 1572481124, "0092") </script>
<script> lineLink("d8e3f45", 1572481124, "0093") </script>
<script> lineLink("d8e3f45", 1572481124, "0094") </script>
<script> lineLink("d8e3f45", 1572481124, "0095") </script>
<script> lineLink("d8e3f45", 1572481124, "0096") </script>
<script> lineLink("d8e3f45", 1572481124, "0097") </script>
<script> lineLink("d8e3f45", 1572481124, "0098") </script>
<script> lineLink("d8e3f45", 1572481124, "0099") </script>
<script> lineLink("d8e3f45", 1572481124, "0100") </script>
<script> lineLink("d8e3f45", 1572481124, "0101") </script>
<script> lineLink("d8e3f45", 1572481124, "0102") </script>
<script> lineLink("d8e3f45", 1572481124, "0103") </script>
<script> lineLink("d8e3f45", 1572481124, "0104") </script>
<script> lineLink("d8e3f45", 1572481124, "0105") </script>
<script> lineLink("74fc015", 1544718930, "0106") </script>
<script> lineLink("74fc015", 1544718930, "0107") </script>
<script> lineLink("d86bb6b", 1542850296, "0108") </script>
<a class=linenum name='L109'>0109</a>  <td valign=top><pre onclick="extendShade(event)">
<span class='comment' title='source.lang.swift.syntaxtype.comment'>//
</span><span class='comment' title='source.lang.swift.syntaxtype.comment'>//  StdioDataTransport.swift
</span><span class='comment' title='source.lang.swift.syntaxtype.comment'>//  SwiftLSPClient
</span><span class='comment' title='source.lang.swift.syntaxtype.comment'>//
</span><span class='comment' title='source.lang.swift.syntaxtype.comment'>//  Created by Matt Massicotte on 2018-10-15.
</span><span class='comment' title='source.lang.swift.syntaxtype.comment'>//  Copyright © 2018 Chime Systems. All rights reserved.
</span><span class='comment' title='source.lang.swift.syntaxtype.comment'>//
</span>
<span class='keyword' title='source.lang.swift.syntaxtype.keyword'>import</span> <span class='identifier' title='success(Optional(SwiftLSPClient.TypeDefinitionResponse.locationArray([])))'><a name='9_7'>Foundation</a></span>

<span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>public</span> <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>class</span> <span class='identifier' title='usrString2'><span class=decl><a name='11_13' href='#' onclick='return expandDecl(this,event);'>StdioDataTransport</a><span class='references'><table><tr><td><a href="LanguageServerProcessHost.swift.html#22_27" onclick='return refClick(this,false,event)'>LanguageServerProcessHost.swift:22</a></td><td><pre>    private let transport: StdioDataTransport</pre></td><tr><td><a href="LanguageServerProcessHost.swift.html#39_25" onclick='return refClick(this,false,event)'>LanguageServerProcessHost.swift:39</a></td><td><pre>        self.transport = StdioDataTransport()</pre></td></table></span></span></span>: <span class='typeidentifier' title='DataTransport.swift'><a name='11_33' href='DataTransport.swift.html#11_16'>DataTransport</a></span> {
    <span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>public</span> <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>let</span> <span class='identifier' title='usrString2'><span class=decl><a name='12_15' href='#' onclick='return expandDecl(this,event);'>stdinPipe</a><span class='references'><table><tr><td><a href="LanguageServerProcessHost.swift.html#43_42" onclick='return refClick(this,false,event)'>LanguageServerProcessHost.swift:43</a></td><td><pre>        process.standardInput = transport.stdinPipe</pre></td><tr><td><a href="StdioDataTransport.swift.html#20_13" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:20</a></td><td><pre>        self.stdinPipe = Pipe()</pre></td><tr><td><a href="StdioDataTransport.swift.html#35_30" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:35</a></td><td><pre>        let fileHandle = self.stdinPipe.fileHandleForWriting</pre></td><tr><td><a href="StdioDataTransport.swift.html#56_37" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:56</a></td><td><pre>            [stdoutPipe, stderrPipe, stdinPipe].forEach { (pipe) in</pre></td></table></span></span></span>: <span class='typeidentifier' title='NSFileHandle.h'><a name='12_26'>Pipe</a></span></span>
    <span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>public</span> <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>let</span> <span class='identifier' title='usrString2'><span class=decl><a name='13_15' href='#' onclick='return expandDecl(this,event);'>stdoutPipe</a><span class='references'><table><tr><td><a href="LanguageServerProcessHost.swift.html#44_43" onclick='return refClick(this,false,event)'>LanguageServerProcessHost.swift:44</a></td><td><pre>        process.standardOutput = transport.stdoutPipe</pre></td><tr><td><a href="StdioDataTransport.swift.html#21_13" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:21</a></td><td><pre>        self.stdoutPipe = Pipe()</pre></td><tr><td><a href="StdioDataTransport.swift.html#56_13" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:56</a></td><td><pre>            [stdoutPipe, stderrPipe, stdinPipe].forEach { (pipe) in</pre></td><tr><td><a href="StdioDataTransport.swift.html#64_8" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:64</a></td><td><pre>        stdoutPipe.fileHandleForReading.readabilityHandler = { [unowned self] (handle) in</pre></td></table></span></span></span>: <span class='typeidentifier' title='NSFileHandle.h'><a name='13_27'>Pipe</a></span></span>
    <span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>public</span> <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>let</span> <span class='identifier' title='usrString2'><span class=decl><a name='14_15' href='#' onclick='return expandDecl(this,event);'>stderrPipe</a><span class='references'><table><tr><td><a href="LanguageServerProcessHost.swift.html#45_42" onclick='return refClick(this,false,event)'>LanguageServerProcessHost.swift:45</a></td><td><pre>        process.standardError = transport.stderrPipe</pre></td><tr><td><a href="StdioDataTransport.swift.html#22_13" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:22</a></td><td><pre>        self.stderrPipe = Pipe()</pre></td><tr><td><a href="StdioDataTransport.swift.html#56_25" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:56</a></td><td><pre>            [stdoutPipe, stderrPipe, stdinPipe].forEach { (pipe) in</pre></td><tr><td><a href="StdioDataTransport.swift.html#74_8" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:74</a></td><td><pre>        stderrPipe.fileHandleForReading.readabilityHandler = { [unowned self] (handle) in</pre></td></table></span></span></span>: <span class='typeidentifier' title='NSFileHandle.h'><a name='14_27'>Pipe</a></span></span>
    <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>var</span> <span class='identifier' title='usrString2'><span class=decl><a name='15_8' href='#' onclick='return expandDecl(this,event);'>readHandler</a><span class='references'><table><tr><td><a href="StdioDataTransport.swift.html#23_13" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:23</a></td><td><pre>        self.readHandler = nil</pre></td><tr><td><a href="StdioDataTransport.swift.html#44_17" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:44</a></td><td><pre>            self.readHandler = handler</pre></td><tr><td><a href="StdioDataTransport.swift.html#91_17" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:91</a></td><td><pre>            self.readHandler?(data)</pre></td></table></span></span></span>: <span class='typeidentifier' title='DataTransport.swift'><a name='15_21' href='DataTransport.swift.html#12_14'>ReadHandler</a></span>?</span>
    <span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>private</span> <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>var</span> <span class='identifier' title='usrString2'><span class=decl><a name='16_16' href='#' onclick='return expandDecl(this,event);'>closed</a><span class='references'><table><tr><td><a href="StdioDataTransport.swift.html#24_13" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:24</a></td><td><pre>        self.closed = false</pre></td><tr><td><a href="StdioDataTransport.swift.html#31_11" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:31</a></td><td><pre>        if closed {</pre></td><tr><td><a href="StdioDataTransport.swift.html#50_20" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:50</a></td><td><pre>            if self.closed {</pre></td><tr><td><a href="StdioDataTransport.swift.html#54_17" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:54</a></td><td><pre>            self.closed = true</pre></td><tr><td><a href="StdioDataTransport.swift.html#87_20" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:87</a></td><td><pre>            if self.closed {</pre></td><tr><td><a href="StdioDataTransport.swift.html#97_20" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:97</a></td><td><pre>            if self.closed {</pre></td></table></span></span></span>: <span class='typeidentifier' title='x86_64-apple-macos.swiftmodule'><a name='16_24'>Bool</a></span></span>
    <span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>private</span> <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>var</span> <span class='identifier' title='usrString2'><span class=decl><a name='17_16' href='#' onclick='return expandDecl(this,event);'>queue</a><span class='references'><table><tr><td><a href="StdioDataTransport.swift.html#25_13" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:25</a></td><td><pre>        self.queue = DispatchQueue(label: "com.chimehq.SwiftLSPClient.StdioDataTransport")</pre></td><tr><td><a href="StdioDataTransport.swift.html#37_13" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:37</a></td><td><pre>        self.queue.async {</pre></td><tr><td><a href="StdioDataTransport.swift.html#43_8" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:43</a></td><td><pre>        queue.sync { [unowned self] in</pre></td><tr><td><a href="StdioDataTransport.swift.html#49_8" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:49</a></td><td><pre>        queue.sync {</pre></td><tr><td><a href="StdioDataTransport.swift.html#86_8" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:86</a></td><td><pre>        queue.async { [unowned self] in</pre></td><tr><td><a href="StdioDataTransport.swift.html#96_8" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:96</a></td><td><pre>        queue.async { [unowned self] in</pre></td></table></span></span></span>: <span class='typeidentifier' title='queue.h'><a name='17_23'>DispatchQueue</a></span></span>
    
    <span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>public</span> <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>init</span>() {
        <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span>.<span class='identifier' title='StdioDataTransport.swift'><a name='20_13' href='StdioDataTransport.swift.html#12_15'>stdinPipe</a></span> = <span class=shade><span class='identifier' title='NSFileHandle.h'><a name='20_25'>Pipe</a></span>()</span>
        <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span>.<span class='identifier' title='StdioDataTransport.swift'><a name='21_13' href='StdioDataTransport.swift.html#13_15'>stdoutPipe</a></span> = <span class=shade><span class='identifier' title='NSFileHandle.h'><a name='21_26'>Pipe</a></span>()</span>
        <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span>.<span class='identifier' title='StdioDataTransport.swift'><a name='22_13' href='StdioDataTransport.swift.html#14_15'>stderrPipe</a></span> = <span class=shade><span class='identifier' title='NSFileHandle.h'><a name='22_26'>Pipe</a></span>()</span>
        <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span>.<span class='identifier' title='StdioDataTransport.swift'><a name='23_13' href='StdioDataTransport.swift.html#15_8'>readHandler</a></span> = <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>nil</span>
        <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span>.<span class='identifier' title='StdioDataTransport.swift'><a name='24_13' href='StdioDataTransport.swift.html#16_16'>closed</a></span> = <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>false</span>
        <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span>.<span class='identifier' title='StdioDataTransport.swift'><a name='25_13' href='StdioDataTransport.swift.html#17_16'>queue</a></span> = <span class=shade><span class='identifier' title='queue.h'><a name='25_21'>DispatchQueue</a></span>(<span class=shade><span class='identifier' title='success(Optional(SwiftLSPClient.TypeDefinitionResponse.locationArray([])))'><a name='25_35'>label</a></span>: <span class='string' title='source.lang.swift.syntaxtype.string'>"com.chimehq.SwiftLSPClient.StdioDataTransport"</span></span>)</span>

        <span class=shade><span class='identifier' title='StdioDataTransport.swift'><a name='27_8' href='StdioDataTransport.swift.html#63_17'>setupFileHandleHandlers</a></span>()</span>
    }</span>
    
    <span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>public</span> <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>func</span> <span class='identifier' title='usrString2'><span class=decl><a name='30_16' onclick='return expandDecl(this,event);'>write</a><span class='references'><table></table></span></span></span>(<span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>_</span> <span class='identifier' title='usrString2'><span class=decl><a name='30_24' onclick='return expandDecl(this,event);'>data</a><span class='references'><table></table></span></span></span>: <span class='typeidentifier' title='x86_64-apple-macos.swiftmodule'><a name='30_30'>Data</a></span></span>) {
        <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>if</span> <span class='identifier' title='StdioDataTransport.swift'><a name='31_11' href='StdioDataTransport.swift.html#16_16'>closed</a></span> <span class=shade>{
            <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>return</span>
        }</span></span>

        <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>let</span> <span class='identifier' title='StdioDataTransport.swift'><a name='35_12'>fileHandle</a></span> = <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span>.<span class='identifier' title='StdioDataTransport.swift'><a name='35_30' href='StdioDataTransport.swift.html#12_15'>stdinPipe</a></span>.<span class='identifier' title='NSFileHandle.h'><a name='35_40'>fileHandleForWriting</a></span></span>

        <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span>.<span class='identifier' title='StdioDataTransport.swift'><a name='37_13' href='StdioDataTransport.swift.html#17_16'>queue</a></span>.<span class='identifier' title='x86_64-apple-macos.swiftmodule'><a name='37_19'>async</a></span> <span class=shade>{
            <span class=shade><span class='identifier' title='StdioDataTransport.swift'><a name='38_12' href='StdioDataTransport.swift.html#35_12'>fileHandle</a></span>.<span class='identifier' title='NSFileHandle.h'><a name='38_23'>write</a></span>(<span class='identifier' title='StdioDataTransport.swift'><a name='38_29' href='StdioDataTransport.swift.html#30_24'>data</a></span>)</span>
        }</span></span>
    }</span>
    
    <span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>public</span> <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>func</span> <span class='identifier' title='usrString2'><span class=decl><a name='42_16' onclick='return expandDecl(this,event);'>setReaderHandler</a><span class='references'><table></table></span></span></span>(<span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>_</span> <span class='identifier' title='usrString2'><span class=decl><a name='42_35' onclick='return expandDecl(this,event);'>handler</a><span class='references'><table></table></span></span></span>: <span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>@escaping</span> (<span class='typeidentifier' title='x86_64-apple-macos.swiftmodule'><a name='42_55'>Data</a></span>) -> <span class='typeidentifier' title='x86_64-apple-macos.swiftmodule'><a name='42_64'>Void</a></span></span>) {
        <span class=shade><span class='identifier' title='StdioDataTransport.swift'><a name='43_8' href='StdioDataTransport.swift.html#17_16'>queue</a></span>.<span class='identifier' title='queue.h'><a name='43_14'>sync</a></span> <span class=shade>{ [<span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>unowned</span> <span class=shade><span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span></span></span>] <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>in</span>
            <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span>.<span class='identifier' title='StdioDataTransport.swift'><a name='44_17' href='StdioDataTransport.swift.html#15_8'>readHandler</a></span> = <span class='identifier' title='StdioDataTransport.swift'><a name='44_31' href='StdioDataTransport.swift.html#42_35'>handler</a></span>
        }</span></span>
    }</span>

    <span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>public</span> <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>func</span> <span class='identifier' title='usrString2'><span class=decl><a name='48_16' href='#' onclick='return expandDecl(this,event);'>close</a><span class='references'><table><tr><td><a href="LanguageServerProcessHost.swift.html#52_27" onclick='return refClick(this,false,event)'>LanguageServerProcessHost.swift:52</a></td><td><pre>            self.transport.close()</pre></td></table></span></span></span>() {
        <span class=shade><span class='identifier' title='StdioDataTransport.swift'><a name='49_8' href='StdioDataTransport.swift.html#17_16'>queue</a></span>.<span class='identifier' title='queue.h'><a name='49_14'>sync</a></span> <span class=shade><span class=shade>{
            <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>if</span> <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span>.<span class='identifier' title='StdioDataTransport.swift'><a name='50_20' href='StdioDataTransport.swift.html#16_16'>closed</a></span> <span class=shade>{
                <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>return</span>
            }</span></span>

            <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span>.<span class='identifier' title='StdioDataTransport.swift'><a name='54_17' href='StdioDataTransport.swift.html#16_16'>closed</a></span> = <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>true</span>

            <span class=shade><span class=shade>[<span class='identifier' title='StdioDataTransport.swift'><a name='56_13' href='StdioDataTransport.swift.html#13_15'>stdoutPipe</a></span>, <span class='identifier' title='StdioDataTransport.swift'><a name='56_25' href='StdioDataTransport.swift.html#14_15'>stderrPipe</a></span>, <span class='identifier' title='StdioDataTransport.swift'><a name='56_37' href='StdioDataTransport.swift.html#12_15'>stdinPipe</a></span>]</span>.<span class='identifier' title='success(Optional(SwiftLSPClient.TypeDefinitionResponse.locationArray([])))'><a name='56_48'>forEach</a></span> <span class=shade><span class=shade>{ (<span class=shade><span class='identifier' title='StdioDataTransport.swift'><a name='56_59'>pipe</a></span></span>) <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>in</span>
                <span class=shade><span class='identifier' title='StdioDataTransport.swift'><a name='57_16' href='StdioDataTransport.swift.html#56_59'>pipe</a></span>.<span class='identifier' title='NSFileHandle.h'><a name='57_21'>fileHandleForWriting</a></span>.<span class='identifier' title='NSFileHandle.h'><a name='57_42'>closeFile</a></span>()</span>
                <span class=shade><span class='identifier' title='StdioDataTransport.swift'><a name='58_16' href='StdioDataTransport.swift.html#56_59'>pipe</a></span>.<span class='identifier' title='NSFileHandle.h'><a name='58_21'>fileHandleForReading</a></span>.<span class='identifier' title='NSFileHandle.h'><a name='58_42'>closeFile</a></span>()</span>
            }</span></span></span>
        }</span></span></span>
    }</span>

    <span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>private</span> <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>func</span> <span class='identifier' title='usrString2'><span class=decl><a name='63_17' href='#' onclick='return expandDecl(this,event);'>setupFileHandleHandlers</a><span class='references'><table><tr><td><a href="StdioDataTransport.swift.html#27_8" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:27</a></td><td><pre>        setupFileHandleHandlers()</pre></td></table></span></span></span>() {
        <span class='identifier' title='StdioDataTransport.swift'><a name='64_8' href='StdioDataTransport.swift.html#13_15'>stdoutPipe</a></span>.<span class='identifier' title='NSFileHandle.h'><a name='64_19'>fileHandleForReading</a></span>.<span class='identifier' title='NSFileHandle.h'><a name='64_40'>readabilityHandler</a></span> = <span class=shade><span class=shade>{ [<span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>unowned</span> <span class=shade><span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span></span></span>] (<span class=shade><span class='identifier' title='StdioDataTransport.swift'><a name='64_79'>handle</a></span></span>) <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>in</span>
            <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>let</span> <span class='identifier' title='StdioDataTransport.swift'><a name='65_16'>data</a></span> = <span class='identifier' title='StdioDataTransport.swift'><a name='65_23' href='StdioDataTransport.swift.html#64_79'>handle</a></span>.<span class='identifier' title='NSFileHandle.h'><a name='65_30'>availableData</a></span></span>

            <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>guard</span> <span class='identifier' title='StdioDataTransport.swift'><a name='67_18' href='StdioDataTransport.swift.html#65_16'>data</a></span>.<span class='identifier' title='x86_64-apple-macos.swiftmodule'><a name='67_23'>count</a></span> > <span class='number' title='source.lang.swift.syntaxtype.number'>0</span> <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>else</span> <span class=shade>{
                <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>return</span>
            }</span></span>

            <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span>.<span class='identifier' title='StdioDataTransport.swift'><a name='71_17' href='StdioDataTransport.swift.html#85_17'>forwardDataToHandler</a></span>(<span class='identifier' title='StdioDataTransport.swift'><a name='71_38' href='StdioDataTransport.swift.html#65_16'>data</a></span>)</span>
        }</span></span>

        <span class='identifier' title='StdioDataTransport.swift'><a name='74_8' href='StdioDataTransport.swift.html#14_15'>stderrPipe</a></span>.<span class='identifier' title='NSFileHandle.h'><a name='74_19'>fileHandleForReading</a></span>.<span class='identifier' title='NSFileHandle.h'><a name='74_40'>readabilityHandler</a></span> = <span class=shade><span class=shade>{ [<span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>unowned</span> <span class=shade><span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span></span></span>] (<span class=shade><span class='identifier' title='StdioDataTransport.swift'><a name='74_79'>handle</a></span></span>) <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>in</span>
            <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>let</span> <span class='identifier' title='StdioDataTransport.swift'><a name='75_16'>data</a></span> = <span class='identifier' title='StdioDataTransport.swift'><a name='75_23' href='StdioDataTransport.swift.html#74_79'>handle</a></span>.<span class='identifier' title='NSFileHandle.h'><a name='75_30'>availableData</a></span></span>

            <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>guard</span> <span class='identifier' title='StdioDataTransport.swift'><a name='77_18' href='StdioDataTransport.swift.html#75_16'>data</a></span>.<span class='identifier' title='x86_64-apple-macos.swiftmodule'><a name='77_23'>count</a></span> > <span class='number' title='source.lang.swift.syntaxtype.number'>0</span> <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>else</span> <span class=shade>{
                <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>return</span>
            }</span></span>

            <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span>.<span class='identifier' title='StdioDataTransport.swift'><a name='81_17' href='StdioDataTransport.swift.html#95_17'>forwardErrorDataToHandler</a></span>(<span class='identifier' title='StdioDataTransport.swift'><a name='81_43' href='StdioDataTransport.swift.html#75_16'>data</a></span>)</span>
        }</span></span>
    }</span>

    <span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>private</span> <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>func</span> <span class='identifier' title='usrString2'><span class=decl><a name='85_17' href='#' onclick='return expandDecl(this,event);'>forwardDataToHandler</a><span class='references'><table><tr><td><a href="StdioDataTransport.swift.html#71_17" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:71</a></td><td><pre>            self.forwardDataToHandler(data)</pre></td></table></span></span></span>(<span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>_</span> <span class='identifier' title='usrString2'><span class=decl><a name='85_40' onclick='return expandDecl(this,event);'>data</a><span class='references'><table></table></span></span></span>: <span class='typeidentifier' title='x86_64-apple-macos.swiftmodule'><a name='85_46'>Data</a></span></span>) {
        <span class=shade><span class='identifier' title='StdioDataTransport.swift'><a name='86_8' href='StdioDataTransport.swift.html#17_16'>queue</a></span>.<span class='identifier' title='x86_64-apple-macos.swiftmodule'><a name='86_14'>async</a></span> <span class=shade><span class=shade>{ [<span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>unowned</span> <span class=shade><span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span></span></span>] <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>in</span>
            <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>if</span> <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span>.<span class='identifier' title='StdioDataTransport.swift'><a name='87_20' href='StdioDataTransport.swift.html#16_16'>closed</a></span> <span class=shade>{
                <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>return</span>
            }</span></span>

            <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span>.<span class='identifier' title='StdioDataTransport.swift'><a name='91_17' href='StdioDataTransport.swift.html#15_8'>readHandler</a></span>?(<span class='identifier' title='StdioDataTransport.swift'><a name='91_30' href='StdioDataTransport.swift.html#85_40'>data</a></span>)</span>
        }</span></span></span>
    }</span>

    <span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>private</span> <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>func</span> <span class='identifier' title='usrString2'><span class=decl><a name='95_17' href='#' onclick='return expandDecl(this,event);'>forwardErrorDataToHandler</a><span class='references'><table><tr><td><a href="StdioDataTransport.swift.html#81_17" onclick='return refClick(this,true,event)'>StdioDataTransport.swift:81</a></td><td><pre>            self.forwardErrorDataToHandler(data)</pre></td></table></span></span></span>(<span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>_</span> <span class='identifier' title='usrString2'><span class=decl><a name='95_45' onclick='return expandDecl(this,event);'>data</a><span class='references'><table></table></span></span></span>: <span class='typeidentifier' title='x86_64-apple-macos.swiftmodule'><a name='95_51'>Data</a></span></span>) {
        <span class=shade><span class='identifier' title='StdioDataTransport.swift'><a name='96_8' href='StdioDataTransport.swift.html#17_16'>queue</a></span>.<span class='identifier' title='x86_64-apple-macos.swiftmodule'><a name='96_14'>async</a></span> <span class=shade><span class=shade>{ [<span class='builtin' title='source.lang.swift.syntaxtype.attribute.builtin'>unowned</span> <span class=shade><span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span></span></span>] <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>in</span>
            <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>if</span> <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>self</span>.<span class='identifier' title='StdioDataTransport.swift'><a name='97_20' href='StdioDataTransport.swift.html#16_16'>closed</a></span> <span class=shade>{
                <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>return</span>
            }</span></span>

            <span class='comment' title='source.lang.swift.syntaxtype.comment'>// Just print for now. Perhaps provide a way to hook
</span>            <span class='comment' title='source.lang.swift.syntaxtype.comment'>// this up to a caller?
</span>            <span class=shade><span class='keyword' title='source.lang.swift.syntaxtype.keyword'>if</span> <span class='keyword' title='source.lang.swift.syntaxtype.keyword'>let</span> <span class=shade><span class='identifier' title='StdioDataTransport.swift'><a name='103_19'>string</a></span></span> = <span class=shade><span class='identifier' title='x86_64-apple-macos.swiftmodule'><a name='103_28'>String</a></span>(<span class=shade><span class='identifier' title='x86_64-apple-macos.swiftmodule'><a name='103_35'>bytes</a></span>: <span class='identifier' title='StdioDataTransport.swift'><a name='103_42' href='StdioDataTransport.swift.html#95_45'>data</a></span></span>, <span class=shade><span class='identifier' title='x86_64-apple-macos.swiftmodule'><a name='103_48'>encoding</a></span>: .<span class='identifier' title='x86_64-apple-macos.swiftmodule'><a name='103_59'>utf8</a></span></span>)</span> <span class=shade>{
                <span class=shade><span class='identifier' title='x86_64-apple-macos.swiftmodule'><a name='104_16'>print</a></span>(<span class='string' title='source.lang.swift.syntaxtype.string'>"stderr: </span>\<span class='string_interpolation_anchor' title='source.lang.swift.syntaxtype.string_interpolation_anchor'>(</span><span class='identifier' title='StdioDataTransport.swift'><a name='104_33' href='StdioDataTransport.swift.html#103_19'>string</a></span><span class='string_interpolation_anchor' title='source.lang.swift.syntaxtype.string_interpolation_anchor'>)</span><span class='string' title='source.lang.swift.syntaxtype.string'>"</span>)</span>
            }</span></span>
        }</span></span></span>
    }</span>
}</span>
