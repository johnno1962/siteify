<html><head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="siteify.css">
<script>

var lastlink;

function expand(a) {
    if ( a.children[0].style.display != "block" ) {
        if ( lastlink )
            lastlink.style.display = "none";
        a.children[0].style.display = "block";
        lastlink = a.children[0];
    }
    else {
        a.children[0].style.display = "none";
        lastlink = null;
    }
    return false;
}

</script></head><body><pre>
0001    <span class='comment'><a name='1_1'>//
0002    </a></span><span class='comment'><a name='2_1'>//  LineGenerators.swift
0003    </a></span><span class='comment'><a name='3_1'>//  refactord
0004    </a></span><span class='comment'><a name='4_1'>//
0005    </a></span><span class='comment'><a name='5_1'>//  Created by John Holdsworth on 19/12/2015.
0006    </a></span><span class='comment'><a name='6_1'>//  Copyright Â© 2015 John Holdsworth. All rights reserved.
0007    </a></span><span class='comment'><a name='7_1'>//
0008    </a></span><span class='comment'><a name='8_1'>//  $Id: //depot/siteify/siteify/LineGenerators.swift#3 $
0009    </a></span><span class='comment'><a name='9_1'>//
0010    </a></span><span class='comment'><a name='10_1'>//  Repo: </a></span><span class='url'><a href='https://github.com/johnno1962/Refactorator'>https://github.com/johnno1962/Refactorator</a></span><span class='comment'><a name='10_53'>
0011    </a></span><span class='comment'><a name='11_1'>//
0012    </a></span>
0013    <span class='keyword'><a name='13_1'>import</a></span> <span class='identifier'><a name='13_8'>Foundation</a></span>
0014    
0015    <span class='keyword'><a name='15_1'>class</a></span> <span class='identifier'><a name='15_7' href='#' title='s:C7siteify13TaskGenerator' onclick='return expand(this);'>TaskGenerator<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#44_24"; event.stopPropagation(); return false;'>main.swift:44</td><td><pre>class StatusGenerator: <b title='source.lang.swift.ref.class'>TaskGenerator</b> {</pre></td></table></span></a></span>: <span class='typeidentifier'><a name='15_22' href='LineGenerators.html#51_7' title='s:C7siteify13FileGenerator'>FileGenerator</a></span> {
0016    
0017        <span class='keyword'><a name='17_5'>let</a></span> <span class='identifier'><a name='17_9' href='#' title='s:vC7siteify13TaskGenerator4taskCSo6NSTask' onclick='return expand(this);'>task<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#54_13"; event.stopPropagation(); return false;'>main.swift:54</td><td><pre>            <b title='source.lang.swift.ref.var.instance'>task</b>.waitUntilExit()</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#55_16"; event.stopPropagation(); return false;'>main.swift:55</td><td><pre>            if <b title='source.lang.swift.ref.var.instance'>task</b>.terminationStatus != EXIT_SUCCESS {</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#35_14"; return false;'>LineGenerators.swift:35</td><td><pre>        self.<b title='source.lang.swift.ref.var.instance'>task</b> = task</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#46_9"; return false;'>LineGenerators.swift:46</td><td><pre>        <b title='source.lang.swift.ref.var.instance'>task</b>.terminate()</pre></td></table></span></a></span>: <span class='typeidentifier'><a name='17_15' title='c:objc(cs)NSTask'>NSTask</a></span>
0018    
0019        <span class='builtin'><a name='19_5'>convenience</a></span> <span class='keyword'><a name='19_17'>init</a></span>( <span class='identifier'><a name='19_23'>command</a></span>: <span class='typeidentifier'><a name='19_32' title='s:SS'>String</a></span>, <span class='identifier'><a name='19_40'>directory</a></span>: <span class='typeidentifier'><a name='19_51' title='s:SS'>String</a></span>? = <span class='keyword'><a name='19_61'>nil</a></span>, <span class='identifier'><a name='19_66'>lineSeparator</a></span>: <span class='typeidentifier'><a name='19_81' title='s:SS'>String</a></span>? = <span class='keyword'><a name='19_91'>nil</a></span> ) {
0020            <span class='keyword'><a name='20_9'>self</a></span>.<span class='keyword'><a name='20_14' href='LineGenerators.html#23_17' title='s:FC7siteify13TaskGeneratorcFT10launchPathSS9argumentsGSaSS_9directoryGSqSS_13lineSeparatorGSqSS__S0_'>init</a></span>( <span class='identifier'><a name='20_20'>launchPath</a></span>: <span class='string'><a name='20_32'>"/bin/bash"</a></span>, <span class='identifier'><a name='20_45'>arguments</a></span>: [<span class='string'><a name='20_57'>"-c"</a></span>, <span class='string'><a name='20_63'>"exec </a></span>\<span class='string_interpolation_anchor'><a name='20_70'>(</a></span><span class='identifier'><a name='20_71'>command</a></span><span class='string_interpolation_anchor'><a name='20_78'>)</a></span><span class='string'><a name='20_79'>"</a></span>], <span class='identifier'><a name='20_83'>directory</a></span>: <span class='identifier'><a name='20_94'>directory</a></span>, <span class='identifier'><a name='20_105'>lineSeparator</a></span>: <span class='identifier'><a name='20_120'>lineSeparator</a></span> )
0021        }
0022    
0023        <span class='builtin'><a name='23_5'>convenience</a></span> <span class='keyword'><a name='23_17' href='#' title='s:FC7siteify13TaskGeneratorcFT10launchPathSS9argumentsGSaSS_9directoryGSqSS_13lineSeparatorGSqSS__S0_' onclick='return expand(this);'>init<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#73_16"; event.stopPropagation(); return false;'>main.swift:73</td><td><pre>    buildLog = <b title='source.lang.swift.ref.function.constructor'>StatusGenerator</b>( launchPath: "/Library/Developer/Toolchains/swift-latest.xctoolchain/usr/bin/swift",</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#82_16"; event.stopPropagation(); return false;'>main.swift:82</td><td><pre>    buildLog = <b title='source.lang.swift.ref.function.constructor'>StatusGenerator</b>( launchPath: "/usr/bin/xcodebuild", arguments: buildargs )</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#20_14"; return false;'>LineGenerators.swift:20</td><td><pre>        self.<b title='source.lang.swift.ref.function.constructor'>init</b>( launchPath: "/bin/bash", arguments: ["-c", "exec \(command)"], directory: directory, lineSeparator: lineSeparator )</pre></td></table></span></a></span>( <span class='identifier'><a name='23_23'>launchPath</a></span>: <span class='typeidentifier'><a name='23_35' title='s:SS'>String</a></span>, <span class='identifier'><a name='23_43'>arguments</a></span>: [<span class='typeidentifier'><a name='23_55' title='s:SS'>String</a></span>] = [], <span class='identifier'><a name='23_69'>directory</a></span>: <span class='typeidentifier'><a name='23_80' title='s:SS'>String</a></span>? = <span class='keyword'><a name='23_90'>nil</a></span>, <span class='identifier'><a name='23_95'>lineSeparator</a></span>: <span class='typeidentifier'><a name='23_110' title='s:SS'>String</a></span>? = <span class='keyword'><a name='23_120'>nil</a></span> ) {
0024    
0025            <span class='keyword'><a name='25_9'>let</a></span> <span class='identifier'><a name='25_13'>task</a></span> = <span class='identifier'><a name='25_20' title='c:objc(cs)NSTask(im)init'>NSTask</a></span>()
0026            <span class='identifier'><a name='26_9'>task</a></span>.<span class='identifier'><a name='26_14' title='c:objc(cs)NSTask(py)launchPath'>launchPath</a></span> = <span class='identifier'><a name='26_27'>launchPath</a></span>
0027            <span class='identifier'><a name='27_9'>task</a></span>.<span class='identifier'><a name='27_14' title='c:objc(cs)NSTask(py)arguments'>arguments</a></span> = <span class='identifier'><a name='27_26'>arguments</a></span>
0028            <span class='identifier'><a name='28_9'>task</a></span>.<span class='identifier'><a name='28_14' title='c:objc(cs)NSTask(py)currentDirectoryPath'>currentDirectoryPath</a></span> = <span class='identifier'><a name='28_37'>directory</a></span> ?? <span class='string'><a name='28_50'>"."</a></span>
0029    
0030            <span class='keyword'><a name='30_9'>self</a></span>.<span class='keyword'><a name='30_14' href='LineGenerators.html#33_5' title='s:FC7siteify13TaskGeneratorcFT4taskCSo6NSTask13lineSeparatorGSqSS__S0_'>init</a></span>( <span class='identifier'><a name='30_20'>task</a></span>: <span class='identifier'><a name='30_26'>task</a></span>, <span class='identifier'><a name='30_32'>lineSeparator</a></span>: <span class='identifier'><a name='30_47'>lineSeparator</a></span> )
0031        }
0032        
0033        <span class='keyword'><a name='33_5' href='#' title='s:FC7siteify13TaskGeneratorcFT4taskCSo6NSTask13lineSeparatorGSqSS__S0_' onclick='return expand(this);'>init<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#30_14"; return false;'>LineGenerators.swift:30</td><td><pre>        self.<b title='source.lang.swift.ref.function.constructor'>init</b>( task: task, lineSeparator: lineSeparator )</pre></td></table></span></a></span>( <span class='identifier'><a name='33_11'>task</a></span>: <span class='typeidentifier'><a name='33_17' title='c:objc(cs)NSTask'>NSTask</a></span>, <span class='identifier'><a name='33_25'>lineSeparator</a></span>: <span class='typeidentifier'><a name='33_40' title='s:SS'>String</a></span>? = <span class='keyword'><a name='33_50'>nil</a></span> ) {
0034    
0035            <span class='keyword'><a name='35_9'>self</a></span>.<span class='identifier'><a name='35_14' href='LineGenerators.html#17_9' title='s:vC7siteify13TaskGenerator4taskCSo6NSTask'>task</a></span> = <span class='identifier'><a name='35_21'>task</a></span>
0036    
0037            <span class='keyword'><a name='37_9'>let</a></span> <span class='identifier'><a name='37_13'>pipe</a></span> = <span class='identifier'><a name='37_20' title='c:objc(cs)NSPipe'>NSPipe</a></span>()
0038            <span class='identifier'><a name='38_9'>task</a></span>.<span class='identifier'><a name='38_14' title='c:objc(cs)NSTask(py)standardOutput'>standardOutput</a></span> = <span class='identifier'><a name='38_31'>pipe</a></span>.<span class='identifier'><a name='38_36' title='c:objc(cs)NSPipe(py)fileHandleForWriting'>fileHandleForWriting</a></span>
0039            <span class='identifier'><a name='39_9'>task</a></span>.<span class='identifier'><a name='39_14' title='c:objc(cs)NSTask(im)launch'>launch</a></span>()
0040    
0041            <span class='identifier'><a name='41_9'>pipe</a></span>.<span class='identifier'><a name='41_14' title='c:objc(cs)NSPipe(py)fileHandleForWriting'>fileHandleForWriting</a></span>.<span class='identifier'><a name='41_35' title='c:objc(cs)NSFileHandle(im)closeFile'>closeFile</a></span>()
0042            <span class='keyword'><a name='42_9'>super</a></span>.<span class='keyword'><a name='42_15' href='LineGenerators.html#62_5' title='s:FC7siteify13FileGeneratorcFT6handleCSo12NSFileHandle13lineSeparatorGSqSS__S0_'>init</a></span>( <span class='identifier'><a name='42_21'>handle</a></span>: <span class='identifier'><a name='42_29'>pipe</a></span>.<span class='identifier'><a name='42_34' title='c:objc(cs)NSPipe(py)fileHandleForReading'>fileHandleForReading</a></span>, <span class='identifier'><a name='42_56'>lineSeparator</a></span>: <span class='identifier'><a name='42_71'>lineSeparator</a></span> )
0043        }
0044    
0045        <span class='keyword'><a name='45_5'>deinit</a></span> {
0046            <span class='identifier'><a name='46_9' href='LineGenerators.html#17_9' title='s:vC7siteify13TaskGenerator4taskCSo6NSTask'>task</a></span>.<span class='identifier'><a name='46_14' title='c:objc(cs)NSTask(im)terminate'>terminate</a></span>()
0047        }
0048    
0049    }
0050    
0051    <span class='keyword'><a name='51_1'>class</a></span> <span class='identifier'><a name='51_7' href='#' title='s:C7siteify13FileGenerator' onclick='return expand(this);'>FileGenerator<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#40_15"; event.stopPropagation(); return false;'>main.swift:40</td><td><pre>let buildLog: <b title='source.lang.swift.ref.class'>FileGenerator</b></pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#67_16"; event.stopPropagation(); return false;'>main.swift:67</td><td><pre>    buildLog = <b title='source.lang.swift.ref.class'>FileGenerator</b>(path: storedLog)!</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#15_22"; return false;'>LineGenerators.swift:15</td><td><pre>class TaskGenerator: <b title='source.lang.swift.ref.class'>FileGenerator</b> {</pre></td></table></span></a></span>: <span class='typeidentifier'><a name='51_22' title='s:Ps13GeneratorType'>GeneratorType</a></span> {
0052    
0053        <span class='keyword'><a name='53_5'>let</a></span> <span class='identifier'><a name='53_9' href='#' title='s:vC7siteify13FileGenerator3eolVs5Int32' onclick='return expand(this);'>eol<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#63_14"; return false;'>LineGenerators.swift:63</td><td><pre>        self.<b title='source.lang.swift.ref.var.instance'>eol</b> = Int32((lineSeparator ?? "\n").utf16.first!)</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#69_83"; return false;'>LineGenerators.swift:69</td><td><pre>            let endOfLine = UnsafeMutablePointer&lt;Int8>( memchr( readBuffer.bytes, <b title='source.lang.swift.ref.var.instance'>eol</b>, readBuffer.length ) )</pre></td></table></span></a></span>: <span class='typeidentifier'><a name='53_14' title='s:Vs5Int32'>Int32</a></span>
0054        <span class='keyword'><a name='54_5'>let</a></span> <span class='identifier'><a name='54_9' href='#' title='s:vC7siteify13FileGenerator6handleCSo12NSFileHandle' onclick='return expand(this);'>handle<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#64_14"; return false;'>LineGenerators.swift:64</td><td><pre>        self.<b title='source.lang.swift.ref.var.instance'>handle</b> = handle</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#82_29"; return false;'>LineGenerators.swift:82</td><td><pre>            let bytesRead = <b title='source.lang.swift.ref.var.instance'>handle</b>.availableData</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#104_9"; return false;'>LineGenerators.swift:104</td><td><pre>        <b title='source.lang.swift.ref.var.instance'>handle</b>.closeFile()</pre></td></table></span></a></span>: <span class='typeidentifier'><a name='54_17' title='c:objc(cs)NSFileHandle'>NSFileHandle</a></span>
0055        <span class='keyword'><a name='55_5'>let</a></span> <span class='identifier'><a name='55_9' href='#' title='s:vC7siteify13FileGenerator10readBufferCSo13NSMutableData' onclick='return expand(this);'>readBuffer<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#69_65"; return false;'>LineGenerators.swift:69</td><td><pre>            let endOfLine = UnsafeMutablePointer&lt;Int8>( memchr( <b title='source.lang.swift.ref.var.instance'>readBuffer</b>.bytes, eol, readBuffer.length ) )</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#69_88"; return false;'>LineGenerators.swift:69</td><td><pre>            let endOfLine = UnsafeMutablePointer&lt;Int8>( memchr( readBuffer.bytes, eol, <b title='source.lang.swift.ref.var.instance'>readBuffer</b>.length ) )</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#73_56"; return false;'>LineGenerators.swift:73</td><td><pre>                let start = UnsafeMutablePointer&lt;Int8>(<b title='source.lang.swift.ref.var.instance'>readBuffer</b>.bytes)</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#77_17"; return false;'>LineGenerators.swift:77</td><td><pre>                <b title='source.lang.swift.ref.var.instance'>readBuffer</b>.replaceBytesInRange( consumed, withBytes:nil, length:0 )</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#84_20"; return false;'>LineGenerators.swift:84</td><td><pre>                if <b title='source.lang.swift.ref.var.instance'>readBuffer</b>.length != 0 {</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#85_49"; return false;'>LineGenerators.swift:85</td><td><pre>                    let last = String.fromData( <b title='source.lang.swift.ref.var.instance'>readBuffer</b> )</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#86_21"; return false;'>LineGenerators.swift:86</td><td><pre>                    <b title='source.lang.swift.ref.var.instance'>readBuffer</b>.length = 0</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#94_13"; return false;'>LineGenerators.swift:94</td><td><pre>            <b title='source.lang.swift.ref.var.instance'>readBuffer</b>.appendData( bytesRead )</pre></td></table></span></a></span> = <span class='identifier'><a name='55_22' title='c:objc(cs)NSMutableData'>NSMutableData</a></span>()
0056    
0057        <span class='builtin'><a name='57_5'>convenience</a></span> <span class='keyword'><a name='57_17' href='#' title='s:FC7siteify13FileGeneratorcFT4pathSS13lineSeparatorGSqSS__GSqS0__' onclick='return expand(this);'>init<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#67_16"; event.stopPropagation(); return false;'>main.swift:67</td><td><pre>    buildLog = <b title='source.lang.swift.ref.function.constructor'>FileGenerator</b>(path: storedLog)!</pre></td></table></span></a></span>?( <span class='identifier'><a name='57_24'>path</a></span>: <span class='typeidentifier'><a name='57_30' title='s:SS'>String</a></span>, <span class='identifier'><a name='57_38'>lineSeparator</a></span>: <span class='typeidentifier'><a name='57_53' title='s:SS'>String</a></span>? = <span class='keyword'><a name='57_63'>nil</a></span> ) {
0058            <span class='keyword'><a name='58_9'>guard</a></span> <span class='keyword'><a name='58_15'>let</a></span> <span class='identifier'><a name='58_19'>handle</a></span> = <span class='identifier'><a name='58_28' title='c:objc(cs)NSFileHandle(cm)fileHandleForReadingAtPath:'>NSFileHandle</a></span>( <span class='identifier'><a name='58_42'>forReadingAtPath</a></span>: <span class='identifier'><a name='58_60'>path</a></span> ) <span class='keyword'><a name='58_67'>else</a></span> { <span class='keyword'><a name='58_74'>return</a></span> <span class='keyword'><a name='58_81'>nil</a></span> }
0059            <span class='keyword'><a name='59_9'>self</a></span>.<span class='keyword'><a name='59_14' href='LineGenerators.html#62_5' title='s:FC7siteify13FileGeneratorcFT6handleCSo12NSFileHandle13lineSeparatorGSqSS__S0_'>init</a></span>( <span class='identifier'><a name='59_20'>handle</a></span>: <span class='identifier'><a name='59_28'>handle</a></span>, <span class='identifier'><a name='59_36'>lineSeparator</a></span>: <span class='identifier'><a name='59_51'>lineSeparator</a></span> )
0060        }
0061    
0062        <span class='keyword'><a name='62_5' href='#' title='s:FC7siteify13FileGeneratorcFT6handleCSo12NSFileHandle13lineSeparatorGSqSS__S0_' onclick='return expand(this);'>init<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#42_15"; return false;'>LineGenerators.swift:42</td><td><pre>        super.<b title='source.lang.swift.ref.function.constructor'>init</b>( handle: pipe.fileHandleForReading, lineSeparator: lineSeparator )</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#59_14"; return false;'>LineGenerators.swift:59</td><td><pre>        self.<b title='source.lang.swift.ref.function.constructor'>init</b>( handle: handle, lineSeparator: lineSeparator )</pre></td></table></span></a></span>( <span class='identifier'><a name='62_11'>handle</a></span>: <span class='typeidentifier'><a name='62_19' title='c:objc(cs)NSFileHandle'>NSFileHandle</a></span>, <span class='identifier'><a name='62_33'>lineSeparator</a></span>: <span class='typeidentifier'><a name='62_48' title='s:SS'>String</a></span>? = <span class='keyword'><a name='62_58'>nil</a></span> ) {
0063            <span class='keyword'><a name='63_9'>self</a></span>.<span class='identifier'><a name='63_14' href='LineGenerators.html#53_9' title='s:vC7siteify13FileGenerator3eolVs5Int32'>eol</a></span> = <span class='identifier'><a name='63_20' title='s:FVs5Int32cFVs6UInt16S_'>Int32</a></span>((<span class='identifier'><a name='63_27'>lineSeparator</a></span> ?? <span class='string'><a name='63_44'>"\n"</a></span>).<span class='identifier'><a name='63_50' title='s:vSS5utf16VSS9UTF16View'>utf16</a></span>.<span class='identifier'><a name='63_56' title='s:vEsPs14CollectionType5firstGSqWx9Generator7Element__'>first</a></span>!)
0064            <span class='keyword'><a name='64_9'>self</a></span>.<span class='identifier'><a name='64_14' href='LineGenerators.html#54_9' title='s:vC7siteify13FileGenerator6handleCSo12NSFileHandle'>handle</a></span> = <span class='identifier'><a name='64_23'>handle</a></span>
0065        }
0066    
0067        <span class='keyword'><a name='67_5'>func</a></span> <span class='identifier'><a name='67_10' href='#' title='s:FC7siteify13FileGenerator4nextFT_GSqSS_' onclick='return expand(this);'>next<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#47_26"; event.stopPropagation(); return false;'>main.swift:47</td><td><pre>        let next = super.<b title='source.lang.swift.ref.function.method.instance'>next</b>()</pre></td></table></span></a></span>() -> <span class='typeidentifier'><a name='67_20' title='s:SS'>String</a></span>? {
0068            <span class='keyword'><a name='68_9'>while</a></span> <span class='keyword'><a name='68_15'>true</a></span> {
0069                <span class='keyword'><a name='69_13'>let</a></span> <span class='identifier'><a name='69_17'>endOfLine</a></span> = <span class='identifier'><a name='69_29' title='s:Sp'>UnsafeMutablePointer</a></span>&lt;<span class='typeidentifier'><a name='69_50' title='s:Vs4Int8'>Int8</a></span>>( <span class='identifier'><a name='69_57' title='c:@F@memchr'>memchr</a></span>( <span class='identifier'><a name='69_65' href='LineGenerators.html#55_9' title='s:vC7siteify13FileGenerator10readBufferCSo13NSMutableData'>readBuffer</a></span>.<span class='identifier'><a name='69_76' title='c:objc(cs)NSData(py)bytes'>bytes</a></span>, <span class='identifier'><a name='69_83' href='LineGenerators.html#53_9' title='s:vC7siteify13FileGenerator3eolVs5Int32'>eol</a></span>, <span class='identifier'><a name='69_88' href='LineGenerators.html#55_9' title='s:vC7siteify13FileGenerator10readBufferCSo13NSMutableData'>readBuffer</a></span>.<span class='identifier'><a name='69_99' title='c:objc(cs)NSMutableData(py)length'>length</a></span> ) )
0070                <span class='keyword'><a name='70_13'>if</a></span> <span class='identifier'><a name='70_16'>endOfLine</a></span> != <span class='keyword'><a name='70_29'>nil</a></span> {
0071                    <span class='identifier'><a name='71_17'>endOfLine</a></span>[<span class='number'><a name='71_27'>0</a></span>] = <span class='number'><a name='71_32'>0</a></span>
0072    
0073                    <span class='keyword'><a name='73_17'>let</a></span> <span class='identifier'><a name='73_21'>start</a></span> = <span class='identifier'><a name='73_29' title='s:Sp'>UnsafeMutablePointer</a></span>&lt;<span class='typeidentifier'><a name='73_50' title='s:Vs4Int8'>Int8</a></span>>(<span class='identifier'><a name='73_56' href='LineGenerators.html#55_9' title='s:vC7siteify13FileGenerator10readBufferCSo13NSMutableData'>readBuffer</a></span>.<span class='identifier'><a name='73_67' title='c:objc(cs)NSData(py)bytes'>bytes</a></span>)
0074                    <span class='keyword'><a name='74_17'>let</a></span> <span class='identifier'><a name='74_21'>line</a></span> = <span class='identifier'><a name='74_28' title='s:SS'>String</a></span>.<span class='identifier'><a name='74_35' title='s:ZFSS11fromCStringFGSPVs4Int8_GSqSS_'>fromCString</a></span>( <span class='identifier'><a name='74_48'>start</a></span> )
0075    
0076                    <span class='keyword'><a name='76_17'>let</a></span> <span class='identifier'><a name='76_21'>consumed</a></span> = <span class='identifier'><a name='76_32' title='c:@F@NSMakeRange'>NSMakeRange</a></span>( <span class='number'><a name='76_45'>0</a></span>, <span class='identifier'><a name='76_48'>endOfLine</a></span> + <span class='number'><a name='76_60'>1</a></span> - <span class='identifier'><a name='76_64'>start</a></span> )
0077                    <span class='identifier'><a name='77_17' href='LineGenerators.html#55_9' title='s:vC7siteify13FileGenerator10readBufferCSo13NSMutableData'>readBuffer</a></span>.<span class='identifier'><a name='77_28' title='c:objc(cs)NSMutableData(im)replaceBytesInRange:withBytes:length:'>replaceBytesInRange</a></span>( <span class='identifier'><a name='77_49'>consumed</a></span>, <span class='identifier'><a name='77_59'>withBytes</a></span>:<span class='keyword'><a name='77_69'>nil</a></span>, <span class='identifier'><a name='77_74'>length</a></span>:<span class='number'><a name='77_81'>0</a></span> )
0078    
0079                    <span class='keyword'><a name='79_17'>return</a></span> <span class='identifier'><a name='79_24'>line</a></span>
0080                }
0081    
0082                <span class='keyword'><a name='82_13'>let</a></span> <span class='identifier'><a name='82_17'>bytesRead</a></span> = <span class='identifier'><a name='82_29' href='LineGenerators.html#54_9' title='s:vC7siteify13FileGenerator6handleCSo12NSFileHandle'>handle</a></span>.<span class='identifier'><a name='82_36' title='c:objc(cs)NSFileHandle(py)availableData'>availableData</a></span>
0083                <span class='keyword'><a name='83_13'>if</a></span> <span class='identifier'><a name='83_16'>bytesRead</a></span>.<span class='identifier'><a name='83_26' title='c:objc(cs)NSData(py)length'>length</a></span> &lt;= <span class='number'><a name='83_36'>0</a></span> {
0084                    <span class='keyword'><a name='84_17'>if</a></span> <span class='identifier'><a name='84_20' href='LineGenerators.html#55_9' title='s:vC7siteify13FileGenerator10readBufferCSo13NSMutableData'>readBuffer</a></span>.<span class='identifier'><a name='84_31' title='c:objc(cs)NSMutableData(py)length'>length</a></span> != <span class='number'><a name='84_41'>0</a></span> {
0085                        <span class='keyword'><a name='85_21'>let</a></span> <span class='identifier'><a name='85_25'>last</a></span> = <span class='identifier'><a name='85_32' title='s:SS'>String</a></span>.<span class='identifier'><a name='85_39' href='LineGenerators.html#110_17' title='s:ZFE7siteifySS8fromDataFTCSo6NSData8encodingSu_GSqSS_'>fromData</a></span>( <span class='identifier'><a name='85_49' href='LineGenerators.html#55_9' title='s:vC7siteify13FileGenerator10readBufferCSo13NSMutableData'>readBuffer</a></span> )
0086                        <span class='identifier'><a name='86_21' href='LineGenerators.html#55_9' title='s:vC7siteify13FileGenerator10readBufferCSo13NSMutableData'>readBuffer</a></span>.<span class='identifier'><a name='86_32' title='c:objc(cs)NSMutableData(py)length'>length</a></span> = <span class='number'><a name='86_41'>0</a></span>
0087                        <span class='keyword'><a name='87_21'>return</a></span> <span class='identifier'><a name='87_28'>last</a></span>
0088                    }
0089                    <span class='keyword'><a name='89_17'>else</a></span> {
0090                        <span class='keyword'><a name='90_21'>break</a></span>
0091                    }
0092                }
0093    
0094                <span class='identifier'><a name='94_13' href='LineGenerators.html#55_9' title='s:vC7siteify13FileGenerator10readBufferCSo13NSMutableData'>readBuffer</a></span>.<span class='identifier'><a name='94_24' title='c:objc(cs)NSMutableData(im)appendData:'>appendData</a></span>( <span class='identifier'><a name='94_36'>bytesRead</a></span> )
0095            }
0096            <span class='keyword'><a name='96_9'>return</a></span> <span class='keyword'><a name='96_16'>nil</a></span>
0097        }
0098    
0099        <span class='keyword'><a name='99_5'>var</a></span> <span class='identifier'><a name='99_9' href='#' title='s:vC7siteify13FileGenerator8sequenceGVs11AnySequenceSS_' onclick='return expand(this);'>sequence<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="main.html#88_22"; event.stopPropagation(); return false;'>main.swift:88</td><td><pre>for line in buildLog.<b title='source.lang.swift.ref.var.instance'>sequence</b> {</pre></td></table></span></a></span>: <span class='typeidentifier'><a name='99_19' title='s:Vs11AnySequence'>AnySequence</a></span>&lt;<span class='typeidentifier'><a name='99_31' title='s:SS'>String</a></span>> {
0100            <span class='keyword'><a name='100_9'>return</a></span> <span class='identifier'><a name='100_16' title='s:FVs11AnySequencecuRd__s13GeneratorTypexzwd__7ElementrFFT_qd__GS_x_'>AnySequence</a></span>({<span class='keyword'><a name='100_29'>self</a></span>})
0101        }
0102    
0103        <span class='keyword'><a name='103_5'>deinit</a></span> {
0104            <span class='identifier'><a name='104_9' href='LineGenerators.html#54_9' title='s:vC7siteify13FileGenerator6handleCSo12NSFileHandle'>handle</a></span>.<span class='identifier'><a name='104_16' title='c:objc(cs)NSFileHandle(im)closeFile'>closeFile</a></span>()
0105        }
0106    }
0107    
0108    <span class='keyword'><a name='108_1'>extension</a></span> <span class='typeidentifier'><a name='108_11' title='s:SS'>String</a></span> {
0109    
0110        <span class='keyword'><a name='110_5'>static</a></span> <span class='keyword'><a name='110_12'>func</a></span> <span class='identifier'><a name='110_17' href='#' title='s:ZFE7siteifySS8fromDataFTCSo6NSData8encodingSu_GSqSS_' onclick='return expand(this);'>fromData<span class='references'><table><tr><td style='text-decoration: underline;' onclick='document.location.href="Entity.html#66_23"; event.stopPropagation(); return false;'>Entity.swift:66</td><td><pre>        return String.<b title='source.lang.swift.ref.function.method.static'>fromData</b>( contents.subdataWithRange( range ) )?</pre></td><tr><td style='text-decoration: underline;' onclick='document.location.href="LineGenerators.html#85_39"; return false;'>LineGenerators.swift:85</td><td><pre>                    let last = String.<b title='source.lang.swift.ref.function.method.static'>fromData</b>( readBuffer )</pre></td></table></span></a></span>( <span class='identifier'><a name='110_27'>data</a></span>: <span class='typeidentifier'><a name='110_33' title='c:objc(cs)NSData'>NSData</a></span>, <span class='identifier'><a name='110_41'>encoding</a></span>: <span class='typeidentifier'><a name='110_51' title='s:Su'>UInt</a></span> = <span class='identifier'><a name='110_58' title='s:v10Foundation20NSUTF8StringEncodingSu'>NSUTF8StringEncoding</a></span> ) -> <span class='typeidentifier'><a name='110_84' title='s:SS'>String</a></span>? {
0111            <span class='keyword'><a name='111_9'>return</a></span> <span class='identifier'><a name='111_16' title='c:objc(cs)NSString(im)initWithData:encoding:'>NSString</a></span>( <span class='identifier'><a name='111_26'>data</a></span>: <span class='identifier'><a name='111_32'>data</a></span>, <span class='identifier'><a name='111_38'>encoding</a></span>: <span class='identifier'><a name='111_48'>encoding</a></span> ) <span class='keyword'><a name='111_59'>as</a></span>? <span class='typeidentifier'><a name='111_63' title='s:SS'>String</a></span>
0112        }
0113    
0114    }
0115    